(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[725],{63533:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/thong-tin-tai-khoan",function(){return n(19461)}])},27776:function(e,t,n){"use strict";var l=n(85893),i=n(67294),s=n(84166),r=n(88196),a=n(92365),u=n(40110);t.Z=e=>{let{children:t}=e,[n,h]=(0,i.useState)(null),[o,c]=(0,i.useState)(null),[d,m]=(0,i.useState)(!1),x=()=>{h(null),c(null),m(!1)};return(0,l.jsxs)(s.Z,{children:[t((e,t)=>{h(e),c(t),m(!0)},x),(0,l.jsx)(r.Z,{open:d,onClose:x,children:n&&(0,l.jsxs)(s.Z,{children:[(0,l.jsx)(a.Z,{sx:{textAlign:"center",textTransform:"uppercase"},children:o}),(0,l.jsx)(u.Z,{children:n})]})})]})}},76598:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var l=n(67294),i=n(21565);let s=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{pauseGlobalLoading:!0},[t,n]=(0,l.useState)(!1),{pauseGlobalLoading:s,resumeGlobalLoading:r}=(0,i.r)();return(0,l.useEffect)(()=>(e.pauseGlobalLoading&&s(),()=>{e.pauseGlobalLoading&&r()}),[e.pauseGlobalLoading,s,r]),{isSubmitting:t,submitForm:async e=>{n(!0);try{return await e()}finally{n(!1)}}}}},19461:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return C}});var l=n(85893),i=n(67294),s=n(64577),r=n(60990),a=n(96788),u=n(44723),h=n(68573),o=n(40492),c=n(51015),d=n(97182),m=n(68963),x=n(27776),p=n(41007),f=n(96727),g=n(21038),j=n(46735),Z=n(76598),y=n(13754),k=n(15243);let v=e=>{let{closeDialogs:t}=e,[n,r]=(0,i.useState)(""),[a,x]=(0,i.useState)(""),[p,g]=(0,i.useState)(""),[v,b]=(0,i.useState)(null),[N,S]=(0,i.useState)(!1),{isSubmitting:C,submitForm:w}=(0,Z.Z)(),{success:P,error:_}=(0,y.l)(),{logout:E}=(0,j.aC)(),T=async e=>{if(e.preventDefault(),b(null),S(!1),!n){b("Vui l\xf2ng nhập mật khẩu hiện tại");return}if(!a){b("Vui l\xf2ng nhập mật khẩu mới");return}if(a.length<6){b("Mật khẩu mới phải c\xf3 \xedt nhất 6 k\xfd tự");return}if(a!==p){b("Mật khẩu x\xe1c nhận kh\xf4ng khớp");return}await w(async()=>{try{if(await s.authService.changePassword({currentPassword:n,newPassword:a,newConfirmPassword:p}))return S(!0),P(k.S.USER.PASSWORD_CHANGE_SUCCESS),setTimeout(()=>{t(),E()},1500),!0;return b("Đổi mật khẩu thất bại"),!1}catch(t){console.error("Password change error:",t);let e=t.message||"C\xf3 lỗi xảy ra khi đổi mật khẩu";return b(e),_(e),!1}})},z=a.length>=6||0===a.length,W=a===p||0===p.length;return(0,l.jsxs)("form",{onSubmit:T,children:[v&&(0,l.jsx)(u.Z,{severity:"error",sx:{mb:2},children:v}),N&&(0,l.jsx)(u.Z,{severity:"success",sx:{mb:2},children:k.S.USER.PASSWORD_CHANGE_SUCCESS}),(0,l.jsxs)(h.ZP,{container:!0,children:[(0,l.jsx)(h.ZP,{item:!0,xs:12,md:12,sx:{my:3},children:(0,l.jsx)(o.Z,{size:"small",type:"password",fullWidth:!0,label:"Mật khẩu hiện tại",placeholder:"Nhập mật khẩu hiện tại",value:n,onChange:e=>r(e.target.value),autoComplete:"off",required:!0,error:!!v&&!n})}),(0,l.jsx)(h.ZP,{item:!0,xs:12,md:12,sx:{my:3},children:(0,l.jsx)(o.Z,{size:"small",type:"password",fullWidth:!0,label:"Mật khẩu mới",placeholder:"Nhập mật khẩu mới",value:a,onChange:e=>x(e.target.value),autoComplete:"off",required:!0,error:!z,helperText:z?"":"Mật khẩu mới phải c\xf3 \xedt nhất 6 k\xfd tự"})}),(0,l.jsx)(h.ZP,{item:!0,xs:12,md:12,sx:{my:3},children:(0,l.jsx)(o.Z,{size:"small",type:"password",fullWidth:!0,label:"X\xe1c nhận mật khẩu",placeholder:"Nhập lại mật khẩu mới",value:p,onChange:e=>g(e.target.value),autoComplete:"off",required:!0,error:!W&&p.length>0,helperText:!W&&p.length>0?"Mật khẩu x\xe1c nhận kh\xf4ng khớp":""})})]}),(0,l.jsxs)(f.Z,{sx:{p:0},children:[(0,l.jsx)(c.Z,{onClick:()=>t(),className:"btn cancleBtn",disabled:C,children:"Hủy"}),(0,l.jsx)(c.Z,{type:"submit",disabled:C||!z||!W||!n,className:"btn saveBtn",startIcon:C?(0,l.jsx)(d.Z,{color:"inherit",size:20}):(0,l.jsx)(m.Z,{}),children:C?"Đang xử l\xfd...":"Lưu"})]})]})};var b=()=>(0,l.jsx)(x.Z,{children:(e,t)=>(0,l.jsx)(g.Z,{title:"Thay đổi mật khẩu",children:(0,l.jsxs)(c.Z,{variant:"outlined",className:"btn",style:{display:"flex",alignItems:"center"},onClick:()=>e((0,l.jsx)(v,{closeDialogs:t}),"Thay đổi mật khẩu"),children:[(0,l.jsx)(p.Z,{sx:{marginRight:2}}),"Đổi mật khẩu"]})})}),N=n(59701),S=()=>{let{getUserInfo:e,getAuthToken:t}=(0,N.Q)(),[n,x]=(0,i.useState)({id:"",userName:"",fullName:"",email:"",phoneNumber:""}),[p,f]=(0,i.useState)(null),[g,j]=(0,i.useState)(null),{isSubmitting:k,submitForm:v}=(0,Z.Z)(),{success:S,error:C}=(0,y.l)(),w=async()=>{try{if("undefined"!==t()&&t()){let t=await (0,s.getData)("User/".concat(e().id),null,void 0,!1);x(t)}}catch(e){console.error(e),C("Kh\xf4ng thể tải th\xf4ng tin người d\xf9ng")}};(0,i.useEffect)(()=>{w()},[]);let P=e=>t=>{let l="checkbox"===t.target.type?t.target.checked:t.target.value;x({...n,[e]:l}),(p||g)&&(f(null),j(null))},_=async e=>{var t;if(e.preventDefault(),f(null),j(null),!(null===(t=n.fullName)||void 0===t?void 0:t.trim())){f("Họ t\xean kh\xf4ng được để trống");return}if(n.email&&!/\S+@\S+\.\S+/.test(n.email)){f("Địa chỉ email kh\xf4ng hợp lệ");return}if(n.phoneNumber&&!/^[0-9]{10,11}$/.test(n.phoneNumber)){f("Số điện thoại kh\xf4ng hợp lệ");return}await v(async()=>{try{var e,t;let l={id:n.id,userName:n.userName,fullName:n.fullName.trim(),email:(null===(e=n.email)||void 0===e?void 0:e.trim())||"",phoneNumber:(null===(t=n.phoneNumber)||void 0===t?void 0:t.trim())||""};if(await s.authService.updateUser(n.id,l)){let e="Cập nhật th\xf4ng tin t\xe0i khoản th\xe0nh c\xf4ng";return j(e),S(e),w(),!0}{let e="Kh\xf4ng thể cập nhật th\xf4ng tin t\xe0i khoản";return f(e),C(e),!1}}catch(t){console.error(t);let e=t.message||"C\xf3 lỗi xảy ra khi cập nhật th\xf4ng tin t\xe0i khoản";return f(e),C(e),!1}})};return(0,l.jsx)(r.Z,{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center",children:(0,l.jsxs)(r.Z,{style:{width:"50%"},children:[(0,l.jsx)(a.Z,{variant:"h5",textTransform:"uppercase",textAlign:"center",mb:3,children:"Th\xf4ng tin t\xe0i khoản"}),p&&(0,l.jsx)(u.Z,{severity:"error",sx:{mb:3},onClose:()=>f(null),children:p}),g&&(0,l.jsx)(u.Z,{severity:"success",sx:{mb:3},onClose:()=>j(null),children:g}),(0,l.jsxs)(h.ZP,{container:!0,children:[(0,l.jsxs)(h.ZP,{item:!0,xs:12,md:12,children:[(0,l.jsx)(h.ZP,{item:!0,xs:12,md:12,sx:{my:3},children:(0,l.jsx)(o.Z,{size:"medium",type:"text",fullWidth:!0,sx:{my:3},label:"T\xe0i khoản",placeholder:"",value:(null==n?void 0:n.userName)||"",onChange:P("userName"),disabled:!0})}),(0,l.jsx)(h.ZP,{item:!0,xs:12,md:12,sx:{my:3},children:(0,l.jsx)(o.Z,{size:"medium",type:"text",fullWidth:!0,label:"T\xean",placeholder:"Nhập họ t\xean của bạn",value:(null==n?void 0:n.fullName)||"",onChange:P("fullName")})}),(0,l.jsx)(h.ZP,{item:!0,xs:12,md:12,sx:{my:3},children:(0,l.jsx)(o.Z,{size:"medium",type:"email",fullWidth:!0,label:"Email",placeholder:"Nhập địa chỉ email",value:(null==n?void 0:n.email)||"",onChange:P("email")})}),(0,l.jsx)(h.ZP,{item:!0,xs:12,md:12,sx:{my:3},children:(0,l.jsx)(o.Z,{size:"medium",type:"text",fullWidth:!0,label:"Số điện thoại",placeholder:"Nhập số điện thoại",value:(null==n?void 0:n.phoneNumber)||"",onChange:P("phoneNumber")})})]}),(0,l.jsxs)(h.ZP,{item:!0,xs:12,md:12,display:"flex",justifyContent:"end",children:[(0,l.jsx)(b,{}),"\xa0",(0,l.jsx)(c.Z,{onClick:_,disabled:k,className:"btn saveBtn",startIcon:k?(0,l.jsx)(d.Z,{size:20,color:"inherit"}):(0,l.jsx)(m.Z,{}),children:k?"Đang lưu...":"Lưu"})]})]})]})})},C=()=>(0,l.jsx)(S,{})}},function(e){e.O(0,[4609,4581,374,492,1694,2888,9774,179],function(){return e(e.s=63533)}),_N_E=e.O()}]);
"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5371],{95906:function(e,l,n){var i=n(11163),a=n(67294),t=n(77584);l.Z=()=>{let{query:e}=(0,i.useRouter)();return{consFilter:(0,a.useMemo)(()=>({page:e.page,type:e.type,tenct:"",loai_ct:(0,t.Z)(null==e?void 0:e.type),huyen:Number(e.huyen)||0,xa:Number(e.xa)||0,song:Number(e.song)||0,luuvuc:Number(e.luuvuc)||0,tieu_luuvuc:Number(e.tieu_luuvuc)||0,tang_chuanuoc:Number(e.tang_chuanuoc)||0,nguonnuoc_kt:""}),[e]),licFilter:(0,a.useMemo)(()=>({page:"string"==typeof e.page?e.page:Array.isArray(e.page)?e.page[0]:void 0,type:"string"==typeof e.type?e.type:Array.isArray(e.type)?e.type[0]:void 0,so_gp:"string"==typeof e.so_gp?e.so_gp:Array.isArray(e.so_gp)?e.so_gp[0]:void 0,cong_trinh:"string"==typeof e.cong_trinh?e.cong_trinh:Array.isArray(e.cong_trinh)?e.cong_trinh[0]:void 0,coquan_cp:"string"==typeof e.coquan_cp?e.coquan_cp:Array.isArray(e.coquan_cp)?e.coquan_cp[0]:void 0,loaihinh_cp:Number(e.loaihinh_cp)||0,hieuluc_gp:"string"==typeof e.hieuluc_gp?e.hieuluc_gp:Array.isArray(e.hieuluc_gp)?e.hieuluc_gp[0]:void 0,loai_ct:Number(e.loai_ct)||(0,t.Z)("string"==typeof e.type?e.type:Array.isArray(e.type)?e.type[0]:""),tang_chuanuoc:Number(e.tang_chuanuoc)||0,huyen:Number(e.huyen)||0,xa:Number(e.xa)||0,tieuvung_qh:Number(e.tieuvung_qh)||0,tochuc_canhan:Number(e.tochuc_canhan)||0,tu_nam:Number(e.tu_nam)||new Date().getFullYear()-5,den_nam:Number(e.den_nam)||new Date().getFullYear()}),[e])}}},49051:function(e,l,n){n.d(l,{b:function(){return t}});var i=n(37340);function a(){let e=(0,i._)(["\n  clip: rect(0 0 0 0);\n  clip-path: inset(50%);\n  height: 1px;\n  overflow: hidden;\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  white-space: nowrap;\n  width: 1px;\n  color: #fff;\n"]);return a=function(){return e},e}let t=(0,n(77527).ZP)("input")(a())},72734:function(e,l,n){n.d(l,{Z:function(){return ea}});var i=n(85893),a=n(67294),t=n(68963),s=n(93454),o=n(68573),d=n(96788),u=n(97182),c=n(50333),r=n(40492),h=n(96727),p=n(51015),x=n(38138),m=n(60990),g=n(76592),v=n(70360),y=n(46577),j=n(8863),f=n(19827),Z=n(10190),C=n(27484),b=n.n(C),P=n(50720),T=n(10586),N=n(17389),_=n(21773),L=n(49051),S=n(64577),G=n(11163),D=n(77584),q=n(94395),z=e=>{var l,n,t;let{data:s,onChange:h}=e,x=(0,G.useRouter)(),[C,z]=(0,a.useState)([]),[k,Q]=(0,a.useState)([]),[w,W]=(0,a.useState)(!1),[H,B]=(0,a.useState)(!1),[A,I]=(0,a.useState)({fileGiayPhep:null,fileGiayToLienQuan:null,fileDonXinCP:null}),[V,M]=(0,a.useState)({id:(null==s?void 0:s.id)||0,idCon:(null==s?void 0:s.idCon)||null,idLoaiGP:(null==s?void 0:s.idLoaiGP)||null,idTCCN:(null==s?void 0:s.idTCCN)||null,tenGP:(null==s?void 0:s.tenGP)||null,soGP:(null==s?void 0:s.soGP)||null,ngayKy:(null==s?void 0:s.ngayKy)||null,ngayCoHieuLuc:(null==s?void 0:s.ngayCoHieuLuc)||null,ngayHetHieuLuc:(null==s?void 0:s.ngayHetHieuLuc)||null,thoiHan:(null==s?void 0:s.thoiHan)||null,fileGiayPhep:(null==s?void 0:s.fileGiayPhep)||null,coQuanCapPhep:(null==s?void 0:s.coQuanCapPhep)||null,fileGiayToLienQuan:(null==s?void 0:s.fileGiayToLienQuan)||null,fileDonXinCP:(null==s?void 0:s.fileDonXinCP)||null,congtrinh:(null==s?void 0:s.congtrinh)||null,tiencq:(null==s?void 0:s.tiencq)||null,tochuc_canhan:(null==s?void 0:s.tochuc_canhan)||null,thanhTraKiemTra:(null==s?void 0:s.thanhTraKiemTra)||null}),F=[{title:"Cấp mới giấy ph\xe9p",value:1},{title:"Cấp lại giấy ph\xe9p",value:2},{title:"Gia hạn giấy ph\xe9p",value:3},{title:"Điều chỉnh giấy ph\xe9p",value:4},{title:"Thu hồi giấy ph\xe9p",value:5}],K=[{title:"BTNMT",value:"BTNMT"},{title:"UBND Tỉnh",value:"UBNDT"},..."/giay-phep/nuoc-duoi-dat/tham-do"===x.pathname?[{title:"STNMT",value:"STNMT"}]:[]],[E,Y]=(0,a.useState)("");(0,a.useEffect)(()=>{(async()=>{var e;let l={so_gp:null,cong_trinh:null,coquan_cp:null,loaihinh_cp:0,hieuluc_gp:null,loai_ct:(0,D.Z)(null===(e=x.query)||void 0===e?void 0:e.type),tang_chuanuoc:0,huyen:0,xa:0,tieuvung_qh:0,tochuc_canhan:0,tu_nam:0,den_nam:0};W(!0),await (0,S.getData)("giay-phep/danh-sach",l).then(e=>{z(e)}).finally(()=>{W(!1)})})()},[x]);let O=e=>l=>{M({...V,[e]:l}),h({...V,[e]:l},A)},U=(e,l)=>{var n;let i=(null===(n=e.target.files)||void 0===n?void 0:n[0])||null,a={...A};switch(l){case"fileGiayPhep":a.fileGiayPhep=i;break;case"fileDonXinCP":a.fileDonXinCP=i;break;case"fileGiayToLienQuan":if(i){let e=new File([i],E||i.name,{type:i.type,lastModified:i.lastModified});a.fileGiayToLienQuan=e}}I(a),h(V,a)};return(0,i.jsxs)(m.Z,{children:[(0,i.jsxs)("fieldset",{children:[(0,i.jsx)("legend",{children:(0,i.jsx)(d.Z,{variant:"subtitle1",className:"legend__title",children:"TH\xd4NG TIN GIẤY PH\xc9P"})}),(0,i.jsxs)(o.ZP,{container:!0,spacing:6,children:[(0,i.jsx)(o.ZP,{item:!0,xs:12,md:6,sm:12,children:(0,i.jsx)(r.Z,{required:!0,size:"small",type:"text",label:"Số giấy ph\xe9p",fullWidth:!0,placeholder:"",value:V.soGP||"",onChange:e=>O("soGP")(e.target.value)})}),(0,i.jsx)(o.ZP,{item:!0,xs:12,md:6,sm:12,children:(0,i.jsx)(P._,{dateAdapter:T.y,children:(0,i.jsx)(N.M,{label:"Ng\xe0y k\xfd",value:b()(V.ngayKy),onChange:e=>O("ngayKy")(e.toDate()),slotProps:{textField:{size:"small",fullWidth:!0,required:!0}},format:"DD/MM/YYYY"})})}),(0,i.jsx)(o.ZP,{item:!0,xs:12,md:6,sm:12,children:(0,i.jsx)(r.Z,{size:"small",type:"text",label:"T\xean văn bản",fullWidth:!0,placeholder:"",value:V.tenGP||"",onChange:e=>O("tenGP")(e.target.value)})}),(0,i.jsx)(o.ZP,{item:!0,xs:12,md:6,sm:12,children:(0,i.jsx)(P._,{dateAdapter:T.y,children:(0,i.jsx)(N.M,{label:"Ng\xe0y c\xf3 hiệu lực",value:b()(V.ngayCoHieuLuc),onChange:e=>O("ngayCoHieuLuc")(e.toDate()),slotProps:{textField:{size:"small",fullWidth:!0,required:!0}},format:"DD/MM/YYYY"})})}),(0,i.jsx)(o.ZP,{item:!0,xs:12,md:6,sm:12,children:(0,i.jsx)(c.Z,{size:"small",options:F,getOptionLabel:e=>e.title,value:F.find(e=>e.value===V.idLoaiGP)||null,isOptionEqualToValue:e=>e.value,onChange:(e,l)=>O("idLoaiGP")((null==l?void 0:l.value)||1),renderInput:e=>(0,i.jsx)(r.Z,{required:!0,...e,fullWidth:!0,label:"Chọn loại h\xecnh CP"})})}),(0,i.jsx)(o.ZP,{item:!0,xs:12,md:6,sm:12,children:(0,i.jsx)(r.Z,{size:"small",type:"text",label:"Thời hạn giấy ph\xe9p",fullWidth:!0,placeholder:"",value:V.thoiHan||"",onChange:e=>O("thoiHan")(e.target.value)})}),(0,i.jsx)(o.ZP,{item:!0,xs:12,md:6,sm:12,children:(0,i.jsx)(c.Z,{size:"small",options:K,getOptionLabel:e=>e.title,value:K.find(e=>e.value===V.coQuanCapPhep)||null,isOptionEqualToValue:e=>e.value,onChange:(e,l)=>O("coQuanCapPhep")((null==l?void 0:l.value)||"UBNDT"),renderInput:e=>(0,i.jsx)(r.Z,{required:!0,...e,fullWidth:!0,label:"Chọn cơ quan CP"})})}),(0,i.jsx)(o.ZP,{item:!0,xs:12,md:6,sm:12,children:(0,i.jsx)(P._,{dateAdapter:T.y,children:(0,i.jsx)(N.M,{label:"Ng\xe0y hết hiệu lực",value:b()(V.ngayHetHieuLuc),onChange:e=>O("ngayHetHieuLuc")(e.toDate()),slotProps:{textField:{size:"small",fullWidth:!0,required:5!=V.idLoaiGP}},format:"DD/MM/YYYY"})})}),V.idLoaiGP&&V.idLoaiGP>1&&V.idLoaiGP<=5?w?(0,i.jsx)(u.Z,{size:20}):(0,i.jsx)(o.ZP,{item:!0,xs:12,md:6,sm:12,children:(0,i.jsx)(c.Z,{size:"small",options:C,getOptionLabel:e=>"".concat(e.soGP," (K\xfd ng\xe0y: ").concat((0,q.p6)(e.ngayKy),")"),isOptionEqualToValue:e=>e.id,value:C.find(e=>e.id===V.idCon)||null,onChange:(e,l)=>{O("idCon")((null==l?void 0:l.id)||0),Q(l||[])},renderInput:e=>(0,i.jsx)(r.Z,{required:!0,...e,fullWidth:!0,label:"Số giấy ph\xe9p cũ"})})}):"",V.idLoaiGP&&V.idLoaiGP>1&&V.idLoaiGP<=5?w?(0,i.jsx)(u.Z,{size:20}):(0,i.jsx)(o.ZP,{item:!0,xs:12,md:6,sm:12,children:(0,i.jsx)(P._,{dateAdapter:T.y,children:(0,i.jsx)(N.M,{disabled:!0,label:"Ng\xe0y k\xfd giấy ph\xe9p cũ",value:b()(k.ngayKy)||null,slotProps:{textField:{size:"small",fullWidth:!0,required:!0}},format:"DD/MM/YYYY"})})}):""]})]}),(0,i.jsxs)("fieldset",{children:[(0,i.jsx)("legend",{children:(0,i.jsx)(d.Z,{variant:"subtitle1",className:"legend__title",children:"T\xc0I LIỆU Đ\xcdNH K\xc8M"})}),(0,i.jsx)(o.ZP,{container:!0,children:(0,i.jsxs)(g.Z,{children:[(0,i.jsx)(v.Z,{children:(0,i.jsxs)(y.Z,{children:[(0,i.jsx)(j.Z,{align:"center",sx:{p:0},children:"Giấy ph\xe9p"}),(0,i.jsx)(j.Z,{align:"center",sx:{p:0},children:"Đơn xin cấp ph\xe9p"}),(0,i.jsx)(j.Z,{align:"center",sx:{p:0},children:"T\xe0i liệu li\xean quan"})]})}),(0,i.jsx)(f.Z,{children:(0,i.jsxs)(y.Z,{children:[(0,i.jsxs)(j.Z,{align:"center",children:[A.fileGiayPhep&&(0,i.jsx)(d.Z,{mb:3,children:null===(l=A.fileGiayPhep)||void 0===l?void 0:l.name}),(0,i.jsxs)(p.Z,{className:"uploadBtn",component:"label",variant:"contained",startIcon:(0,i.jsx)(_.Z,{}),href:"#fileGiayPhep",children:["Upload file",(0,i.jsx)(L.b,{type:"file",id:"fileGiayPhep",onChange:e=>U(e,"fileGiayPhep"),accept:".pdf"})]})]}),(0,i.jsxs)(j.Z,{align:"center",children:[A.fileDonXinCP&&(0,i.jsx)(d.Z,{mb:3,children:null===(n=A.fileDonXinCP)||void 0===n?void 0:n.name}),(0,i.jsxs)(p.Z,{className:"uploadBtn",component:"label",variant:"contained",startIcon:(0,i.jsx)(_.Z,{}),href:"#fileDonXinCP",children:["Upload file",(0,i.jsx)(L.b,{type:"file",id:"fileDonXinCP",onChange:e=>U(e,"fileDonXinCP"),accept:".pdf"})]})]}),(0,i.jsxs)(j.Z,{align:"center",children:[A.fileGiayToLienQuan&&(0,i.jsx)(d.Z,{mb:3,children:null===(t=A.fileGiayToLienQuan)||void 0===t?void 0:t.name}),(0,i.jsx)(p.Z,{className:"uploadBtn",onClick:()=>B(!0),variant:"contained",startIcon:(0,i.jsx)(_.Z,{}),children:"Upload file"}),H&&(0,i.jsx)(Z.Z,{open:H,onClose:()=>B(!1),children:(0,i.jsxs)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"white",padding:"20px",borderRadius:"5px",display:"flex",flexDirection:"column",gap:"16px",minWidth:"400px"},children:[(0,i.jsx)(d.Z,{variant:"h6",children:"Giấy tờ li\xean quan(PDF)"}),(0,i.jsxs)(p.Z,{className:"uploadBtn",component:"label",variant:"contained",startIcon:(0,i.jsx)(_.Z,{}),href:"#fileGiayToLienQuan",children:["Chọn file",(0,i.jsx)(L.b,{type:"file",id:"fileGiayToLienQuan",onChange:e=>U(e,"fileGiayToLienQuan"),accept:".pdf"})]}),(0,i.jsx)(r.Z,{fullWidth:!0,size:"small",type:"text",placeholder:"T\xean t\xe0i liệu",value:E,onChange:e=>{Y(e.target.value)}}),(0,i.jsxs)(o.ZP,{container:!0,columnSpacing:3,children:[(0,i.jsx)(o.ZP,{item:!0,sm:6,children:(0,i.jsx)(p.Z,{variant:"contained",fullWidth:!0,color:"primary",onClick:()=>{if(A.fileGiayToLienQuan&&E){let e=A.fileGiayToLienQuan,l=new File([e],E,{type:e.type,lastModified:e.lastModified});I({...A,fileGiayToLienQuan:l}),h(V,{...A,fileGiayToLienQuan:l})}B(!1)},children:"Th\xeam"})}),(0,i.jsx)(o.ZP,{item:!0,sm:6,children:(0,i.jsx)(p.Z,{variant:"contained",color:"error",fullWidth:!0,onClick:()=>{A.fileGiayToLienQuan&&E&&(I({...A,fileGiayToLienQuan:null}),h(V,{...A,fileGiayToLienQuan:null})),B(!1)},children:"Hủy"})})]})]})})]})]})})]})})]})]})},k=n(55201),Q=n(53839),w=n(52857),W=n(27776),H=e=>{let{data:l,onChange:n}=e,[t,s]=(0,a.useState)({id:null,tenTCCN:null,diaChi:null,maSoThue:null,sdt:null,fax:null,email:null,giamDoc:null,nguoiDuocUyQuyen:null,nguoiDaiDienPhapLuat:null});(0,a.useEffect)(()=>{l&&s(l)},[l]);let d=e=>l=>{let i="checkbox"===l.target.type?l.target.checked:l.target.value;s({...t,[e]:i}),n({...t,[e]:i})};return(0,i.jsxs)(o.ZP,{container:!0,spacing:4,rowSpacing:1,children:[(0,i.jsx)(o.ZP,{item:!0,xs:12,md:12,sm:12,sx:{my:2},children:(0,i.jsx)(r.Z,{size:"small",type:"text",label:"T\xean doanh nghiệp",fullWidth:!0,required:!0,placeholder:"",defaultValue:null==t?void 0:t.tenTCCN,onChange:d("tenTCCN")})}),(0,i.jsx)(o.ZP,{item:!0,xs:12,md:12,sm:12,sx:{my:2},children:(0,i.jsx)(r.Z,{size:"small",type:"text",label:"Địa chỉ",fullWidth:!0,required:!0,defaultValue:null==t?void 0:t.diaChi,onChange:d("diaChi")})}),(0,i.jsx)(o.ZP,{item:!0,xs:12,md:12,sm:12,sx:{my:2},children:(0,i.jsx)(r.Z,{size:"small",type:"text",label:"Gi\xe1m đốc",fullWidth:!0,placeholder:"",defaultValue:null==t?void 0:t.giamDoc,onChange:d("giamDoc")})}),(0,i.jsx)(o.ZP,{item:!0,xs:12,md:12,sm:12,sx:{my:2},children:(0,i.jsx)(r.Z,{size:"small",type:"text",label:"Đại diện ph\xe1p l\xfd",fullWidth:!0,placeholder:"",defaultValue:null==t?void 0:t.nguoiDaiDienPhapLuat,onChange:d("nguoiDaiDienPhapLuat")})}),(0,i.jsx)(o.ZP,{item:!0,xs:12,md:12,sm:12,sx:{my:2},children:(0,i.jsx)(r.Z,{size:"small",type:"text",label:"Số điện thoại",fullWidth:!0,placeholder:"",defaultValue:null==t?void 0:t.sdt,onChange:d("sdt")})}),(0,i.jsx)(o.ZP,{item:!0,xs:12,md:12,sm:12,sx:{my:2},children:(0,i.jsx)(r.Z,{size:"small",type:"text",label:"Số Fax",fullWidth:!0,placeholder:"",defaultValue:null==t?void 0:t.fax,onChange:d("fax")})}),(0,i.jsx)(o.ZP,{item:!0,xs:12,md:12,sm:12,sx:{my:2},children:(0,i.jsx)(r.Z,{size:"small",type:"text",label:"Email",fullWidth:!0,placeholder:"",defaultValue:null==t?void 0:t.email,onChange:d("email")})}),(0,i.jsx)(o.ZP,{item:!0,xs:12,md:12,sm:12,sx:{my:2},children:(0,i.jsx)(r.Z,{size:"small",type:"text",label:"M\xe3 số thuế",fullWidth:!0,placeholder:"",defaultValue:null==t?void 0:t.maSoThue,onChange:d("maSoThue")})})]})};let B=e=>{let{data:l,closeDialogs:n,setPostSuccess:s}=e,[d,c]=(0,a.useState)(l),[r,x]=(0,a.useState)(!1);return(0,i.jsxs)("form",{children:[(0,i.jsx)(o.ZP,{container:!0,gap:3,children:(0,i.jsx)(o.ZP,{item:!0,xs:12,children:(0,i.jsx)(H,{data:l,onChange:e=>{c(e)}})})}),(0,i.jsxs)(h.Z,{sx:{p:0,mt:5},children:[(0,i.jsxs)(p.Z,{size:"small",onClick:()=>{n()},className:"btn cancleBtn",children:[" ","Hủy"," "]}),(0,i.jsxs)(p.Z,{onClick:e=>{e.preventDefault(),(async()=>{try{x(!0),await (0,S.saveData)("to-chuc-ca-nhan/luu",d)&&(c({}),"function"==typeof s&&s(!0))}catch(e){}finally{x(!1),n()}})()},disabled:r,className:"btn saveBtn",children:[" ",r?(0,i.jsx)(u.Z,{color:"inherit",size:20}):(0,i.jsx)(t.Z,{})," \xa0 Lưu"," "]})]})]})};var A=e=>{let{isEdit:l,data:n,setPostSuccess:a}=e,t=l?"Sửa th\xf4ng tin doanh nghiệp":"Th\xeam mới th\xf4ng tin doanh nghiệp";return(0,i.jsx)(W.Z,{children:(e,s)=>(0,i.jsx)(m.Z,{children:l?(0,i.jsx)(w.Z,{onClick:()=>e((0,i.jsx)(B,{data:n,closeDialogs:s,setPostSuccess:a}),t),children:(0,i.jsx)(k.Z,{className:"tableActionBtn"})}):(0,i.jsx)(p.Z,{size:"small",variant:"outlined",startIcon:(0,i.jsx)(Q.Z,{}),onClick:()=>e((0,i.jsx)(B,{data:n,closeDialogs:s,setPostSuccess:a}),t),children:"Th\xeam mới"})})})},I=n(36720);let V={id:0,idCon:null,idLoaiGP:null,idTCCN:null,idCT:null,tenGP:null,soGP:null,ngayKy:null,ngayCoHieuLuc:null,ngayHetHieuLuc:null,thoiHan:null,coQuanCapPhep:null,fileGiayPhep:null,fileGiayToLienQuan:null,fileDonXinCP:null,congtrinh:null,tochuc_canhan:null,tiencq:null,thanhTraKiemTra:null};var M=n(66891),F=n(15715),K=n(22e3),E=n(25026),Y=n(14312),O=n(80539),U=n(44723),X=n(51423),R=n(49986),J=n(88148),$=n(17071),ee=n(89090),el=e=>{var l;let{data:n,onChange:u}=e,c=n?n.map(e=>{var l;return{id:e.id,soVanBan:e.soVanBan,thoiGian:null!==(l=null==e?void 0:e.thoiGian)&&void 0!==l?l:null,tienPhat:e.tienPhat,dot:e.dot,donVi:e.donVi,ghiChu:e.ghiChu,taiLieu:e.taiLieu,fileUpload:null,daXoa:!1}}):[],[h,x]=(0,a.useState)(c),[C,S]=(0,a.useState)(-1),[G,D]=(0,a.useState)({id:void 0,soVanBan:void 0,thoiGian:void 0,tienPhat:void 0,dot:void 0,donVi:void 0,ghiChu:void 0,taiLieu:void 0,daXoa:!1,fileUpload:null}),[z,k]=(0,a.useState)(null),W=!!z,[H,B]=(0,a.useState)(null),[A,I]=(0,a.useState)(null),V=(e,l)=>{k(e.currentTarget),B(l)},M=()=>{k(null)},F=()=>{null!==H&&(K(H),B(null)),k(null)},K=e=>{x(l=>{let n=[...l],i=n.splice(e,1)[0];return(null==i?void 0:i.id)!==void 0&&(null==i?void 0:i.id)!==null&&(null==i?void 0:i.id)>0&&x(e=>[...e,{...i,daXoa:!0}]),n}),u(h),k(null)},el=e=>{var l;let n=null===(l=e.target.files)||void 0===l?void 0:l[0];n&&D(e=>{var l;let i={...e};return i.fileUpload=n,i.taiLieu="".concat(null===(l=i.soVanBan)||void 0===l?void 0:l.replace(/\//g,"_").toLowerCase(),".pdf"),i})},en=e=>l=>{D(n=>{let i={...n};return i[e]=l,i})},[ei,ea]=(0,a.useState)(!1),et=()=>ea(!1),es=(e,l,n)=>{ea(!0),S(e),"add"===n&&D({...Object.fromEntries(Object.keys(G||{}).map(e=>[e,null])),daXoa:!1,soVanBan:null,thoiGian:null,tienPhat:null,dot:null,...l}),"update"===n&&D({...l})};return(0,a.useEffect)(()=>{u(h)},[h]),(0,i.jsx)(E.Z,{component:s.Z,children:(0,i.jsxs)("fieldset",{children:[(0,i.jsx)("legend",{children:(0,i.jsx)(d.Z,{variant:"subtitle1",className:"legend__title",children:"THANH TRA KIỂM TRA"})}),(0,i.jsxs)(g.Z,{sx:{minWidth:650},"aria-label":"simple table",children:[(0,i.jsx)(v.Z,{children:(0,i.jsxs)(y.Z,{children:[(0,i.jsx)(j.Z,{size:"small",align:"center",children:"TT"}),(0,i.jsx)(j.Z,{size:"small",align:"center",children:"Số văn bản"}),(0,i.jsx)(j.Z,{size:"small",align:"center",children:"Đợt thanh tra"}),(0,i.jsx)(j.Z,{size:"small",align:"center",children:"Đơn vị thanh tra"}),(0,i.jsx)(j.Z,{size:"small",align:"center",children:"Ng\xe0y thanh tra"}),(0,i.jsx)(j.Z,{size:"small",align:"center",children:"Tổng số tiền phạt vi phạm h\xe0nh ch\xednh"}),(0,i.jsx)(j.Z,{size:"small",align:"center",children:"Ghi ch\xfa"}),(0,i.jsx)(j.Z,{size:"small",align:"center",children:"Văn bản kết luận"}),(0,i.jsx)(j.Z,{size:"small",align:"center",padding:"checkbox",rowSpan:2,children:(0,i.jsxs)(m.Z,{children:[(0,i.jsx)(w.Z,{"aria-label":"add",className:"tableActionBtn",onClick:()=>es(0,null,"add"),children:(0,i.jsx)(Q.Z,{})}),(0,i.jsx)(Z.Z,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",open:ei,onClose:et,closeAfterTransition:!0,slots:{backdrop:Y.Z},slotProps:{backdrop:{timeout:500}},children:(0,i.jsx)(O.Z,{in:ei,children:(0,i.jsxs)(m.Z,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:600,bgcolor:"background.paper",boxShadow:24,pt:2,px:4,pb:3,width:600},children:[(0,i.jsx)(d.Z,{id:"transition-modal-title",variant:"h6",component:"h2",align:"center",py:3,children:"TH\xd4NG TIN THANH TRA KIỂM TRA"}),A?(0,i.jsx)(U.Z,{sx:{my:2},severity:"warning",children:A}):null,(0,i.jsxs)(o.ZP,{container:!0,spacing:4,children:[(0,i.jsx)(o.ZP,{item:!0,md:12,children:(0,i.jsx)(r.Z,{name:"soVanBan",fullWidth:!0,label:"Số băn bản",placeholder:"Số băn bản",size:"small",value:G.soVanBan,onChange:e=>en("soVanBan")(e.target.value)})}),(0,i.jsx)(o.ZP,{item:!0,md:12,children:(0,i.jsx)(r.Z,{name:"dot",fullWidth:!0,label:"Đợt thanh tra",placeholder:"Đợt thanh tra",size:"small",value:G.dot,onChange:e=>en("dot")(e.target.value)})}),(0,i.jsx)(o.ZP,{item:!0,md:12,children:(0,i.jsx)(r.Z,{name:"donVi",fullWidth:!0,label:"Đơn vị thanh tra",placeholder:"Đơn vị thanh tra",size:"small",value:G.donVi,onChange:e=>en("donVi")(e.target.value)})}),(0,i.jsx)(o.ZP,{item:!0,md:6,children:(0,i.jsx)(P._,{dateAdapter:T.y,children:(0,i.jsx)(N.M,{value:b()(G.thoiGian),onChange:e=>en("thoiGian")(e.toDate()),slotProps:{textField:{size:"small",fullWidth:!0}},label:"Ng\xe0y thanh tra",format:"DD/MM/YYYY"})})}),(0,i.jsx)(o.ZP,{item:!0,md:6,children:(0,i.jsx)(r.Z,{name:"tienPhat",fullWidth:!0,label:"Tổng tiền phạt",placeholder:"Tổng tiền phạt",size:"small",value:G.tienPhat,onChange:e=>en("tienPhat")(e.target.value)})}),(0,i.jsx)(o.ZP,{item:!0,md:12,children:(0,i.jsx)(r.Z,{name:"ghiChu",fullWidth:!0,multiline:!0,label:"Ghi ch\xfa",placeholder:"Ghi ch\xfa",size:"small",value:G.ghiChu,onChange:e=>en("ghiChu")(e.target.value)})}),(0,i.jsxs)(o.ZP,{item:!0,md:12,children:[G.fileUpload&&(0,i.jsx)(d.Z,{mb:3,children:null===(l=G.fileUpload)||void 0===l?void 0:l.name}),(0,i.jsxs)(p.Z,{fullWidth:!0,className:"uploadBtn",component:"label",variant:"contained",startIcon:(0,i.jsx)(_.Z,{}),href:"#file-upload-licFee",children:["Văn bản kết luận thanh tra",(0,i.jsx)(L.b,{type:"file",onChange:e=>el(e),accept:".pdf"})]})]})]}),(0,i.jsxs)(o.ZP,{item:!0,sx:{display:"flex",justifyContent:"end",py:2},children:[(0,i.jsx)(p.Z,{startIcon:(0,i.jsx)(t.Z,{}),sx:{ml:1},variant:"outlined",color:"primary",onClick:()=>{void 0!==G.soVanBan||void 0!==G.thoiGian?(C>0?x(e=>{let l=[...e];return l[C]={...G},l}):x(e=>[...e,G]),u([...h]),S(-1),et()):I("Số băn bản v\xe0 Ng\xe0y k\xfd kh\xf4ng được để trống")},children:"Lưu"}),(0,i.jsx)(p.Z,{startIcon:(0,i.jsx)(J.Z,{}),sx:{ml:1},variant:"outlined",color:"error",onClick:et,children:"Huỷ"})]})]})})})]})})]})}),(0,i.jsx)(f.Z,{children:h.map((e,l)=>{var n;return(0,i.jsxs)(y.Z,{children:[(0,i.jsx)(j.Z,{className:"text-center  size='small' align-middle font-13",children:l+1}),(0,i.jsx)(j.Z,{children:e.soVanBan}),(0,i.jsx)(j.Z,{children:e.dot}),(0,i.jsx)(j.Z,{children:e.donVi}),(0,i.jsx)(j.Z,{children:(0,q.p6)(e.thoiGian)}),(0,i.jsx)(j.Z,{children:e.tienPhat}),(0,i.jsx)(j.Z,{children:e.ghiChu}),(0,i.jsx)(j.Z,{children:null===(n=e.fileUpload)||void 0===n?void 0:n.name}),(0,i.jsx)(j.Z,{size:"small",align:"center",children:(0,i.jsxs)(m.Z,{className:"group_btn",children:[(0,i.jsx)(w.Z,{"aria-describedby":"".concat(e.soVanBan,"-").concat(l),onClick:()=>es(l,e,"update"),"data-row-id":"".concat(e.soVanBan,"-").concat(l),children:(0,i.jsx)($.Z,{className:"tableActionBtn"})}),(0,i.jsx)(w.Z,{"aria-describedby":"".concat(e.soVanBan,"-").concat(l),onClick:e=>V(e,l),"data-row-id":"".concat(e.soVanBan,"-").concat(l),children:(0,i.jsx)(ee.Z,{className:"tableActionBtn deleteBtn"})}),(0,i.jsx)(X.ZP,{id:W?"".concat(e.soVanBan,"-").concat(l):void 0,open:W,anchorEl:z,onClose:M,anchorOrigin:{vertical:"bottom",horizontal:"left"},children:(0,i.jsxs)(U.Z,{severity:"warning",children:["X\xf3a bản ghi n\xe0y ?",(0,i.jsx)(m.Z,{sx:{justifyContent:"center",paddingTop:4,width:"100%"},children:(0,i.jsxs)(R.Z,{variant:"outlined","aria-label":"outlined button group",children:[(0,i.jsx)(p.Z,{size:"small",onClick:()=>F(),children:"Đ\xfang"}),(0,i.jsx)(p.Z,{color:"error",size:"small",onClick:()=>M(),children:"Kh\xf4ng"})]})})]})})]})})]},l)})})]})]})})},en=e=>{var l;let{data:n,onChange:u}=e,c=n?n.map(e=>({id:e.id,idCon:e.idCon,soQDTCQ:e.soQDTCQ,ngayKy:b()(null==e?void 0:e.ngayKy),tongTienCQ:e.tongTienCQ,filePDF:e.filePDF,ghiChu:e.ghiChu})):[],[h,x]=(0,a.useState)(c),[C,S]=(0,a.useState)(-1),[G,D]=(0,a.useState)({id:void 0,idCon:void 0,soQDTCQ:void 0,ngayKy:void 0,tongTienCQ:void 0,filePDF:void 0,ghiChu:void 0}),[z,k]=(0,a.useState)([]),[W,H]=(0,a.useState)(null),B=!!W,[A,I]=(0,a.useState)(null),[V,M]=(0,a.useState)(null),F=(e,l)=>{H(e.currentTarget),I(l)},K=()=>{H(null)},el=()=>{null!==A&&(en(A),I(null)),H(null)},en=e=>{x(l=>{let n=[...l],i=n.splice(e,1)[0];return(null==i?void 0:i.id)!==void 0&&(null==i?void 0:i.id)>0&&k(e=>[...e,i]),n}),u(h,z),H(null)},ei=e=>{var l;let n=null===(l=e.target.files)||void 0===l?void 0:l[0];n&&D(e=>{var l;let i={...e};return i.fileUpload=n,i.filePDF="".concat(null===(l=i.soQDTCQ)||void 0===l?void 0:l.replace(/\//g,"_").toLowerCase(),".pdf"),i})},ea=e=>l=>{D(n=>{let i={...n};return i[e]=l,i})},[et,es]=(0,a.useState)(!1),eo=()=>es(!1),ed=(e,l,n)=>{es(!0),S(e),"add"===n&&D({...Object.fromEntries(Object.keys(G||{}).map(e=>[e,null]))}),"update"===n&&D({...l})};return(0,a.useEffect)(()=>{u(h,z)},[h,z]),(0,i.jsx)(E.Z,{component:s.Z,children:(0,i.jsxs)("fieldset",{children:[(0,i.jsx)("legend",{children:(0,i.jsx)(d.Z,{variant:"subtitle1",className:"legend__title",children:"TIỀN CẤP QUYỀN"})}),(0,i.jsxs)(g.Z,{sx:{minWidth:650},"aria-label":"simple table",children:[(0,i.jsx)(v.Z,{children:(0,i.jsxs)(y.Z,{children:[(0,i.jsx)(j.Z,{size:"small",align:"center",children:"TT"}),(0,i.jsx)(j.Z,{size:"small",align:"center",children:"SỐ QĐ TCQ"}),(0,i.jsx)(j.Z,{size:"small",align:"center",children:"Ng\xe0y k\xfd"}),(0,i.jsx)(j.Z,{size:"small",align:"center",children:"Tổng TCQ"}),(0,i.jsx)(j.Z,{size:"small",align:"center",children:"File TCQ"}),(0,i.jsx)(j.Z,{size:"small",align:"center",padding:"checkbox",rowSpan:2,children:(0,i.jsxs)(m.Z,{children:[(0,i.jsx)(w.Z,{"aria-label":"add",className:"tableActionBtn",onClick:()=>ed(0,null,"add"),children:(0,i.jsx)(Q.Z,{})}),(0,i.jsx)(Z.Z,{"aria-labelledby":"transition-modal-title","aria-describedby":"transition-modal-description",open:et,onClose:eo,closeAfterTransition:!0,slots:{backdrop:Y.Z},slotProps:{backdrop:{timeout:500}},children:(0,i.jsx)(O.Z,{in:et,children:(0,i.jsxs)(m.Z,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:600,bgcolor:"background.paper",boxShadow:24,pt:2,px:4,pb:3,width:600},children:[(0,i.jsx)(d.Z,{id:"transition-modal-title",variant:"h6",component:"h2",align:"center",py:3,children:"TH\xd4NG TIN TIỀN CẤP QUYỀN"}),V?(0,i.jsx)(U.Z,{sx:{my:2},severity:"warning",children:V}):null,(0,i.jsxs)(o.ZP,{container:!0,spacing:4,children:[(0,i.jsx)(o.ZP,{item:!0,md:12,children:(0,i.jsx)(r.Z,{name:"soQDTCQ",fullWidth:!0,label:"Số quyết định",placeholder:"Số quyết định",size:"small",value:G.soQDTCQ,onChange:e=>ea("soQDTCQ")(e.target.value)})}),(0,i.jsx)(o.ZP,{item:!0,md:6,children:(0,i.jsx)(P._,{dateAdapter:T.y,children:(0,i.jsx)(N.M,{value:b()(G.ngayKy),onChange:e=>ea("ngayKy")(e.toDate()),slotProps:{textField:{size:"small",fullWidth:!0}},label:"Ng\xe0y k\xfd",format:"DD/MM/YYYY"})})}),(0,i.jsx)(o.ZP,{item:!0,md:6,children:(0,i.jsx)(r.Z,{name:"tongTienCQ",fullWidth:!0,label:"Tổng tiền cấp quyền",placeholder:"Tổng tiền cấp quyền",size:"small",value:G.tongTienCQ,onChange:e=>ea("tongTienCQ")(e.target.value)})}),(0,i.jsxs)(o.ZP,{item:!0,md:12,children:[G.fileUpload&&(0,i.jsx)(d.Z,{mb:3,children:null===(l=G.fileUpload)||void 0===l?void 0:l.name}),(0,i.jsxs)(p.Z,{fullWidth:!0,className:"uploadBtn",component:"label",variant:"contained",startIcon:(0,i.jsx)(_.Z,{}),href:"#file-upload-licFee",children:["Upload file",(0,i.jsx)(L.b,{type:"file",onChange:e=>ei(e),accept:".pdf"})]})]})]}),(0,i.jsxs)(o.ZP,{item:!0,sx:{display:"flex",justifyContent:"end",py:2},children:[(0,i.jsx)(p.Z,{startIcon:(0,i.jsx)(t.Z,{}),sx:{ml:1},variant:"outlined",color:"primary",onClick:()=>{void 0!==G.soQDTCQ||void 0!==G.ngayKy?(C>0?x(e=>{let l=[...e];return l[C]={...G},l}):x(e=>[...e,G]),u([...h],[...z]),S(-1),eo()):M("Số quyết định v\xe0 Ng\xe0y k\xfd kh\xf4ng được để trống")},children:"Lưu"}),(0,i.jsx)(p.Z,{startIcon:(0,i.jsx)(J.Z,{}),sx:{ml:1},variant:"outlined",color:"error",onClick:eo,children:"Huỷ"})]})]})})})]})})]})}),(0,i.jsx)(f.Z,{children:h.map((e,l)=>{var n;return(0,i.jsxs)(y.Z,{children:[(0,i.jsx)(j.Z,{className:"text-center  size='small' align-middle font-13",children:l+1}),(0,i.jsx)(j.Z,{children:e.soQDTCQ}),(0,i.jsx)(j.Z,{children:(0,q.p6)(e.ngayKy)}),(0,i.jsx)(j.Z,{children:e.tongTienCQ}),(0,i.jsx)(j.Z,{children:null===(n=e.fileUpload)||void 0===n?void 0:n.name}),(0,i.jsx)(j.Z,{size:"small",align:"center",children:(0,i.jsxs)(m.Z,{className:"group_btn",children:[(0,i.jsx)(w.Z,{"aria-describedby":"".concat(e.soQDTCQ,"-").concat(l),onClick:()=>ed(l,e,"update"),"data-row-id":"".concat(e.soQDTCQ,"-").concat(l),children:(0,i.jsx)($.Z,{className:"tableActionBtn"})}),(0,i.jsx)(w.Z,{"aria-describedby":"".concat(e.soQDTCQ,"-").concat(l),onClick:e=>F(e,l),"data-row-id":"".concat(e.soQDTCQ,"-").concat(l),children:(0,i.jsx)(ee.Z,{className:"tableActionBtn deleteBtn"})}),(0,i.jsx)(X.ZP,{id:B?"".concat(e.soQDTCQ,"-").concat(l):void 0,open:B,anchorEl:W,onClose:K,anchorOrigin:{vertical:"bottom",horizontal:"left"},children:(0,i.jsxs)(U.Z,{severity:"warning",children:["X\xf3a bản ghi n\xe0y ?",(0,i.jsx)(m.Z,{sx:{justifyContent:"center",paddingTop:4,width:"100%"},children:(0,i.jsxs)(R.Z,{variant:"outlined","aria-label":"outlined button group",children:[(0,i.jsx)(p.Z,{size:"small",onClick:()=>el(),children:"Đ\xfang"}),(0,i.jsx)(p.Z,{color:"error",size:"small",onClick:()=>K(),children:"Kh\xf4ng"})]})})]})})]})})]},l)})})]})]})})};let ei=e=>{var l,n,x,m,g,v,y;let{data:j,closeDialogs:f,setPostSuccess:Z}=e,C=(0,G.useRouter)(),[P,T]=(0,a.useState)(!0),[N,_]=(0,a.useState)(!1),[L,D]=(0,a.useState)([]),[q,k]=(0,a.useState)((null==j?void 0:j.tochuc_canhan)||{}),[Q,w]=(0,a.useState)({}),[W,H]=(0,a.useState)(!1),[B,E]=(0,a.useState)(j),[Y,O]=(0,a.useState)(j||null),U=e=>{e?O(e):O(null)},[X,R]=(0,a.useState)((null==j?void 0:j.tiencq)||null),[J,$]=(0,a.useState)((null==j?void 0:j.thanhTraKiemTra)||[]),ee=async()=>{_(!0),T(!0);try{var e,l,n,i;let a="pdf/giay-phep/".concat(null==B?void 0:null===(e=B.coQuanCapPhep)||void 0===e?void 0:e.toLowerCase(),"/").concat(C.query.page,"/").concat(b()(null==B?void 0:B.ngayKy).year(),"/").concat(null==B?void 0:null===(l=B.soGP)||void 0===l?void 0:l.replace(/\//g,"_").toLowerCase()),t={filePath:a,fileName:"".concat(null==B?void 0:null===(n=B.soGP)||void 0===n?void 0:n.replace(/\//g,"_").toLowerCase(),".pdf"),file:Q.fileGiayPhep},s={filePath:Q.fileDonXinCP?a:null,fileName:Q.fileDonXinCP?"donxincapphep.pdf":null,file:Q.fileDonXinCP||null},o={filePath:Q.fileGiayToLienQuan?a:null,fileName:(null===(i=Q.fileGiayToLienQuan)||void 0===i?void 0:i.name)||null,file:Q.fileGiayToLienQuan||null},d={...B,congtrinh:Y,tochuc_canhan:q,tiencq:X,thanhTraKiemTra:J,fileGiayPhep:"".concat(a,"/").concat(t.fileName),fileDonXinCP:s.fileName?"".concat(a,"/").concat(s.fileName):null,fileGiayToLienQuan:o.fileName?"".concat(a,"/").concat(o.fileName):null};await S.giayphepService.save(d)&&(t.file instanceof File&&await (0,S.uploadFile)(t.file,t.filePath,t.fileName),s.file instanceof File&&s.filePath&&s.fileName&&await (0,S.uploadFile)(s.file,s.filePath,s.fileName),o.file instanceof File&&o.filePath&&o.fileName&&await (0,S.uploadFile)(o.file,o.filePath,o.fileName),null==X||X.forEach(async e=>{if(e.fileUpload){var l;let n="pdf/tien-cap-quyen/".concat(null===(l=e.coQuanCapPhep)||void 0===l?void 0:l.toLowerCase(),"/").concat(b()(e.ngayKy).year());await (0,S.uploadFile)(e.fileUpload,n,e.filePDF)}}),null==J||J.forEach(async e=>{if(e.taiLieu instanceof File){var l,n;let i="pdf/thanh-tra/".concat(null===(l=e.soVanBan)||void 0===l?void 0:l.toLowerCase(),"/").concat(b()(e.thoiGian).year()),a="".concat(null===(n=e.soVanBan)||void 0===n?void 0:n.replace(/\//g,"_").toLowerCase(),".pdf");await (0,S.uploadFile)(e.taiLieu,i,a)}})),O(null),E(V),R(null),"function"==typeof Z&&Z(!0)}catch(e){console.error("Error in handleApiCall:",e)}finally{_(!1),T(!1),f()}};return(0,a.useEffect)(()=>{let e=!0;return(async()=>{T(!0);try{let l=await (0,S.getData)("to-chuc-ca-nhan/danh-sach");if((null==B?void 0:B.idTCCN)&&(null==B?void 0:B.idTCCN)>0){let e=await (0,S.getData)("to-chuc-ca-nhan/".concat(null==B?void 0:B.idTCCN));k(e)}e&&D(l)}catch(l){e&&D([])}finally{e&&T(!1)}})(),()=>{e=!1}},[W]),(0,i.jsxs)(s.Z,{children:[(0,i.jsxs)(o.ZP,{container:!0,gap:3,children:[(0,i.jsx)(o.ZP,{item:!0,xs:12,children:(0,i.jsxs)("fieldset",{children:[(0,i.jsx)("legend",{children:(0,i.jsx)(d.Z,{variant:"subtitle1",className:"legend__title",children:"TH\xd4NG TIN TỔ CHỨC/C\xc1 NH\xc2N"})}),P?(0,i.jsx)(u.Z,{size:20}):(0,i.jsxs)(o.ZP,{container:!0,spacing:6,alignContent:"center",children:[(0,i.jsx)(o.ZP,{item:!0,xs:12,md:4,sm:12,children:(0,i.jsx)(c.Z,{size:"small",options:L,getOptionLabel:e=>e.tenTCCN,value:(null==L?void 0:L.find(e=>e.id===(null==q?void 0:q.id)))||null,isOptionEqualToValue:(e,l)=>e.id===(null==l?void 0:l.id),onChange:(e,l)=>k(l),renderInput:e=>(0,i.jsx)(r.Z,{required:!0,...e,fullWidth:!0,label:"Chủ giấy ph\xe9p",disabled:P})})}),(0,i.jsx)(o.ZP,{item:!0,xs:12,md:6,sm:12,children:(0,i.jsx)(r.Z,{label:"Địa chỉ",size:"small",type:"text",fullWidth:!0,placeholder:"",value:(null==q?void 0:q.diaChi)||""})}),(0,i.jsx)(o.ZP,{item:!0,xs:12,md:2,sm:12,alignContent:"center",children:(0,i.jsx)(A,{isEdit:!1,setPostSuccess:()=>{H(e=>!e)}})})]})]})}),(0,i.jsx)(o.ZP,{item:!0,xs:12,children:(0,i.jsx)(z,{data:j,onChange:(e,l)=>{w(l),E(e)}})}),(0,i.jsx)(o.ZP,{item:!0,xs:12,children:(0,i.jsx)(en,{data:X,onChange:e=>{R(e)}})}),(0,i.jsx)(o.ZP,{item:!0,xs:12,children:(0,i.jsx)(el,{data:J,onChange:e=>{$(e)}})}),(0,i.jsx)(o.ZP,{item:!0,xs:12,children:(null===(l=C.query)||void 0===l?void 0:l.type)=="nuoc-mat"?(0,i.jsx)(F.Z,{props:null==j?void 0:j.congtrinh.id,onChange:U}):(null===(n=C.query)||void 0===n?void 0:n.type)=="ktsd-nuoc-duoi-dat"||(null===(x=C.query)||void 0===x?void 0:x.type)=="td-nuoc-duoi-dat"||(null===(m=C.query)||void 0===m?void 0:m.type)=="hnk-nuoc-duoi-dat"?(0,i.jsx)(M.Z,{props:null==j?void 0:null===(g=j.congtrinh)||void 0===g?void 0:g.id,onChange:U}):(null===(v=C.query)||void 0===v?void 0:v.type)=="xa-thai"?(0,i.jsx)(K.Z,{props:null==j?void 0:null===(y=j.congtrinh)||void 0===y?void 0:y.id,onChange:U}):""})]}),(0,i.jsxs)(h.Z,{sx:{p:0,mt:5},children:[(0,i.jsx)(p.Z,{size:"small",onClick:()=>{f()},className:"btn cancleBtn",children:"Hủy"}),(0,i.jsxs)(p.Z,{disabled:N,className:"btn saveBtn",onClick:e=>{if(e.preventDefault(),!(null==q?void 0:q.id)||!(null==B?void 0:B.soGP)||!(null==B?void 0:B.ngayKy)||!(null==B?void 0:B.ngayCoHieuLuc)||!(null==B?void 0:B.coQuanCapPhep)||!(null==B?void 0:B.idLoaiGP)||!(null==Y?void 0:Y.idLoaiCT)||!Q.fileGiayPhep&&Q.fileGiayPhep){let e;(null==Y?void 0:Y.idLoaiCT)?(null==Y?void 0:Y.tenCT)?(null==Y?void 0:Y.viTriCT)?(null==q?void 0:q.id)?(null==B?void 0:B.soGP)?(null==B?void 0:B.ngayKy)?(null==B?void 0:B.ngayCoHieuLuc)?(null==B?void 0:B.coQuanCapPhep)?(null==B?void 0:B.idLoaiGP)?(null==B?void 0:B.fileGiayPhep)||(null==B?void 0:B.fileGiayPhep)||(e="File giấy ph\xe9p *"):e="Loại giấy ph\xe9p *":e="Cơ quan cấp ph\xe9p *":e="Ng\xe0y c\xf3 hiệu lực *":e="Ng\xe0y k\xfd giấy ph\xe9p*":e="Số giấy ph\xe9p*":e="Chủ giấy ph\xe9p*":e="Địa điểm c\xf4ng tr\xecnh*":e="T\xean c\xf4ng tr\xecnh*":e="Loại c\xf4ng tr\xecnh*",e&&(0,I.yv)("".concat(e," kh\xf4ng được để trống"),{variant:"warning"});return}ee()},children:[" ",N?(0,i.jsx)(u.Z,{color:"inherit",size:20}):(0,i.jsx)(t.Z,{})," \xa0 Lưu"," "]})]})]})};var ea=(0,a.forwardRef)((e,l)=>{let{setPostSuccess:n}=e,[t,s]=(0,a.useState)(null);return(0,a.useImperativeHandle)(l,()=>({handleOpenDialog:(e,l)=>{t&&t(e,l,"edit"===e?"Sửa giấy ph\xe9p":"Th\xeam mới giấy ph\xe9p")}})),(0,i.jsx)(x.Z,{children:(e,l)=>(t||s(()=>(a,t,s)=>{e((0,i.jsx)(ei,{data:"edit"===a?t:void 0,closeDialogs:l,setPostSuccess:n}),s)}),null)})})},15371:function(e,l,n){n.r(l);var i=n(85893),a=n(60990),t=n(68573),s=n(96788),o=n(67294),d=n(94395),u=n(95587),c=n(64577),r=n(92131),h=n(95906),p=n(39892);l.default=()=>{let[e,l]=(0,o.useState)([]),[n,x]=(0,o.useState)(0),[m,g]=(0,o.useState)(10),[v,y]=(0,o.useState)(0),[j,f]=(0,o.useState)(!1),Z=(0,o.useRef)(!0),{licFilter:C}=(0,h.Z)(),b=[{id:"stt",label:"STT",align:"center",width:60,format:(l,i)=>e.indexOf(i)>=0?n*m+e.indexOf(i)+1:""},{id:"soGP",label:"Số giấy ph\xe9p",align:"left",format:(e,l)=>(0,i.jsx)(u.Z,{name:l.soGP,src:l.fileGiayPhep})},{id:"tenGP",label:"T\xean giấy ph\xe9p",align:"left",width:200,maxWidth:200},{id:"ngayKy",label:"Ng\xe0y k\xfd giấy ph\xe9p",align:"left",format:e=>(0,d.p6)(e)},{id:"thoiHan",label:"Thời hạn cấp ph\xe9p",align:"left"},{id:"coQuanCapPhep",label:"Cơ quan cấp ph\xe9p",align:"left"},{id:"tenTCCN",label:"T\xean chủ giấy ph\xe9p",align:"left",format:(e,l)=>{var n;return null===(n=l.tochuc_canhan)||void 0===n?void 0:n.tenTCCN},width:300,maxWidth:300},{id:"diaChiTCCN",label:"Địa chỉ chủ giấy ph\xe9p",align:"left",format:(e,l)=>{var n;return null===(n=l.tochuc_canhan)||void 0===n?void 0:n.diaChi},width:300,maxWidth:300},{id:"tenCT",label:"T\xean c\xf4ng tr\xecnh",align:"left",format:(e,l)=>{var n;return null===(n=l.congtrinh)||void 0===n?void 0:n.tenCT},width:300,maxWidth:300},{id:"viTriCT",label:"Vị tr\xed c\xf4ng tr\xecnh",align:"left",format:(e,l)=>{var n;return null===(n=l.congtrinh)||void 0===n?void 0:n.viTriCT},width:300,maxWidth:300},{id:"tongLuuLuong",label:"Lưu lượng khai th\xe1c",align:"left",format:(e,l)=>{var n,i,a;return(null===(n=l.congtrinh)||void 0===n?void 0:n.tongLuuLuong)>0?"".concat(null===(i=l.congtrinh)||void 0===i?void 0:i.tongLuuLuong," (").concat((null===(a=l.congtrinh)||void 0===a?void 0:a.donViTinhLuuLuong)||"Kh\xf4ng x\xe1c định",")"):"-"}},{id:"mucdich_kt",label:"Mục đ\xedch khai th\xe1c",align:"left",format:(e,l)=>{var n;return Array.isArray(null===(n=l.congtrinh)||void 0===n?void 0:n.mucdich_kt)?l.congtrinh.mucdich_kt.map((e,n)=>(0,i.jsxs)(a.Z,{children:[e.mucDich,n<l.congtrinh.mucdich_kt.length-1?", ":""]},n)):""}}];return(0,o.useEffect)(()=>{(async()=>{f(!0);let e={...C},i=n+1,a=await c.giayphepService.getAll({...e,pageNumber:i,pageSize:m});Z.current&&(l((null==a?void 0:a.items)||[]),y((null==a?void 0:a.totalItems)||0)),f(!1)})()},[JSON.stringify(C),n,m]),(0,i.jsxs)(t.ZP,{className:"_text_center",children:[(0,i.jsx)(s.Z,{className:"font-weight-bold",sx:{mt:3},variant:"h6",children:"THỐNG K\xca KẾT QUẢ CẤP PH\xc9P"}),(0,i.jsx)(r.Z,{onExport:{id:"ket-qua-cap-phep",fileName:"ket-qua-cap-phep"}}),(0,i.jsxs)(s.Z,{sx:{mt:3,textAlign:"start"},variant:"subtitle1",children:["C\xf3",(0,i.jsx)("strong",{children:(0,i.jsxs)("em",{children:[" ",v," "]})}),"giấy ph\xe9p được cấp từ",(0,i.jsx)("strong",{children:(0,i.jsxs)("em",{children:[" ",C.tu_nam," "]})}),"đến",(0,i.jsx)("strong",{children:(0,i.jsxs)("em",{children:[" ",C.den_nam," "]})})]}),(0,i.jsx)(p.Z,{columns:b,rows:e,page:n,rowsPerPage:m,totalItems:v,onPageChange:e=>{x(e)},onRowsPerPageChange:e=>{g(e),x(0)},pagination:!0,loading:j,id:"ket-qua-cap-phep"})]})}},92131:function(e,l,n){var i=n(85893),a=n(38855),t=n(53525),s=n(15821),o=n(53839),d=n(88539),u=n(68573),c=n(40492),r=n(6897),h=n(94143),p=n(29346),x=n(15972),m=n(4291),g=n(96788),v=n(50333),y=n(51015),j=n(67294),f=n(72734),Z=n(11163),C=n(64577),b=n(77584),P=n(50720),T=n(17389),N=n(10586),_=n(27484),L=n.n(_),S=n(82431),G=n(95906),D=n(59701);l.Z=e=>{var l,n,_,q,z,k,Q,w,W,H,B,A,I,V,M,F,K,E,Y,O,U;let{onChange:X,onExport:R}=e,J=(0,Z.useRouter)(),$=(0,j.useRef)(null),[ee,el]=(0,j.useState)(!1),{licFilter:en}=(0,G.Z)(),[ei,ea]=(0,j.useState)(en),[et,es]=(0,j.useState)([]),[eo,ed]=(0,j.useState)([]),[eu,ec]=(0,j.useState)([]),[er,eh]=(0,j.useState)([]),[ep,ex]=(0,j.useState)([]),[em,eg]=(0,j.useState)([]),[ev,ey]=(0,j.useState)(null),{getPermissionMap:ej}=(0,D.Q)();(0,j.useEffect)(()=>{(async()=>{ey(await ej(J.asPath))})()},[J.asPath]);let ef=(e,l)=>{ea(n=>({...n,[l]:e}))},eZ=()=>{let e={...ei,page:String(ei.page||"giay-phep"),type:String(ei.type||"")};J.push({pathname:J.pathname,query:e},void 0,{shallow:!0}).then(()=>{null==X||X(e)})};return(0,j.useEffect)(()=>{let e=!0;return(async()=>{try{let l=await (0,C.getData)("to-chuc-ca-nhan/danh-sach");e&&ec(l)}catch(e){console.log(e)}})(),()=>{e=!1}},[ei.huyen]),(0,j.useEffect)(()=>{(async()=>{try{let e=await C.masterDataCache.getDanhSachHuyen();if(eh(e),ei.huyen){let e=await C.masterDataCache.getDanhSachXa(ei.huyen);ex(e)}let l=await C.masterDataCache.getLuuVucSong();eg(l);let n=await C.masterDataCache.getLoaiCongTrinh();ed(n);let i=await C.masterDataCache.getLoaiGP();es(i)}catch(e){console.error(e)}})()},[ei.huyen]),(0,i.jsx)(d.Z,{variant:"dense",children:(0,i.jsx)("form",{onSubmit:e=>{e.preventDefault(),eZ()},children:(0,i.jsxs)(u.ZP,{container:!0,spacing:2,sx:{paddingY:3},children:[(null===(l=J.query)||void 0===l?void 0:l.type)=="nuoc-mat"||(null===(n=J.query)||void 0===n?void 0:n.type)==="ktsd-nuoc-duoi-dat"||(null===(_=J.query)||void 0===_?void 0:_.type)==="td-nuoc-duoi-dat"||(null===(q=J.query)||void 0===q?void 0:q.type)==="hnk-nuoc-duoi-dat"||(null===(z=J.query)||void 0===z?void 0:z.type)=="xa-thai"?(0,i.jsx)(u.ZP,{item:!0,xs:12,md:3,py:0,children:(0,i.jsx)(c.Z,{sx:{p:0},size:"small",fullWidth:!0,variant:"outlined",placeholder:"Số giấy ph\xe9p...",onChange:e=>ef(e.target.value,"so_gp")})}):"",(0,i.jsx)(u.ZP,{item:!0,xs:12,md:2,py:0,children:(0,i.jsxs)(r.Z,{size:"small",fullWidth:!0,children:[(0,i.jsx)(h.Z,{id:"license-type-select",children:"Cơ quan cấp ph\xe9p"}),(0,i.jsxs)(p.Z,{labelId:"license-type-select",id:"demo-select-small",value:ei.coquan_cp||"",label:"Cơ quan cấp ph\xe9p",onChange:e=>ef(e.target.value,"coquan_cp"),children:[(0,i.jsx)(x.Z,{value:"",children:"Cơ quan cấp ph\xe9p"}),[{label:"BTNMT",value:"BTNMT"},{label:"UBND Tỉnh",value:"UBNDT"},{label:"Sở TNMT",value:"STNMT"}].map((e,l)=>(0,i.jsx)(x.Z,{value:e.value,children:e.label},l))]})]})}),(0,i.jsx)(u.ZP,{item:!0,xs:12,md:2,py:0,children:(0,i.jsxs)(r.Z,{size:"small",fullWidth:!0,children:[(0,i.jsx)(h.Z,{id:"license-type-select",children:"Loại h\xecnh cấp ph\xe9p"}),(0,i.jsxs)(p.Z,{labelId:"license-type-select",id:"demo-select-small",value:ei.loaihinh_cp||"",label:"Loại h\xecnh cấp ph\xe9p",onChange:e=>ef(e.target.value,"loaihinh_cp"),children:[(0,i.jsx)(x.Z,{value:0,children:"Loại h\xecnh cấp ph\xe9p"}),et.map((e,l)=>(0,i.jsx)(x.Z,{value:e.id,children:e.tenLoaiGP},l))]})]})}),(0,i.jsx)(u.ZP,{item:!0,xs:12,md:2,py:0,children:(0,i.jsxs)(r.Z,{size:"small",fullWidth:!0,children:[(0,i.jsx)(h.Z,{id:"license-type-select",children:"Hiệu lực giấy ph\xe9p"}),(0,i.jsxs)(p.Z,{labelId:"license-type-select",id:"demo-select-small",value:ei.hieuluc_gp||"",label:"Hiệu  lực giấy ph\xe9p",onChange:e=>ef(e.target.value,"hieuluc_gp"),children:[(0,i.jsx)(x.Z,{value:"",children:"Hiệu lực giấy ph\xe9p"}),[{label:"C\xf2n hiệu lực",value:"con-hieu-luc"},{label:"Hết hiệu lực",value:"het-hieu-luc"},{label:"Sắp hết hiệu lực",value:"sap-het-hieu-luc"},{label:"Đ\xe3 bị thu hồi",value:"da-bi-thu-hoi"}].map((e,l)=>(0,i.jsx)(x.Z,{value:e.value,children:e.label},l))]})]})}),(null===(k=J.query)||void 0===k?void 0:k.type)!=="nuoc-duoi-dat"?(0,i.jsx)(u.ZP,{item:!0,xs:12,md:2,py:0,children:(0,i.jsxs)(r.Z,{size:"small",fullWidth:!0,children:[(0,i.jsx)(h.Z,{id:"construction-type-select",children:"Loại c\xf4ng tr\xecnh"}),(0,i.jsxs)(p.Z,{labelId:"construction-type-select",id:"demo-select-small",value:(null!==(U=ei.loai_ct)&&void 0!==U?U:0)>3?ei.loai_ct:(0,b.Z)(null===(Q=J.query)||void 0===Q?void 0:Q.type),label:"Loại c\xf4ng tr\xecnh",onChange:e=>ef(e.target.value,"loai_ct"),children:[(0,i.jsx)(x.Z,{value:(0,b.Z)(null===(w=J.query)||void 0===w?void 0:w.type),children:"Loại c\xf4ng tr\xecnh"}),(null===(W=J.query)||void 0===W?void 0:W.type)==="nuoc-mat"?eo.filter(e=>1===e.idCha).map((e,l)=>(0,i.jsx)(x.Z,{value:e.id,children:e.tenLoaiCT},l)):(null===(H=J.query)||void 0===H?void 0:H.type)==="xa-thai"?eo.filter(e=>3===e.idCha).map((e,l)=>(0,i.jsx)(x.Z,{value:e.id,children:e.tenLoaiCT},l)):eo.filter(e=>0===e.idCha).map((e,l)=>[(0,i.jsx)(x.Z,{value:e.id,sx:{fontWeight:"bold"},children:e.tenLoaiCT},"subheader-".concat(l)),...eo.filter(l=>l.idCha===e.id).map((e,l)=>(0,i.jsx)(x.Z,{value:e.id,children:e.tenLoaiCT},"child-".concat(l)))])]})]})}):"",(null===(B=J.query)||void 0===B?void 0:B.type)=="nuoc-mat"||(null===(A=J.query)||void 0===A?void 0:A.type)==="ktsd-nuoc-duoi-dat"||(null===(I=J.query)||void 0===I?void 0:I.type)==="td-nuoc-duoi-dat"||(null===(V=J.query)||void 0===V?void 0:V.type)==="hnk-nuoc-duoi-dat"||(null===(M=J.query)||void 0===M?void 0:M.type)=="xa-thai"?(0,i.jsx)(u.ZP,{item:!0,xs:12,md:3,py:0,children:(0,i.jsx)(c.Z,{sx:{p:0},size:"small",fullWidth:!0,variant:"outlined",placeholder:"T\xean c\xf4ng tr\xecnh...",onChange:e=>ef(e.target.value,"cong_trinh")})}):"",(0,i.jsx)(u.ZP,{item:!0,xs:12,md:12,children:(0,i.jsx)(m.Z,{in:ee,children:(0,i.jsxs)("fieldset",{children:[(0,i.jsx)("legend",{children:(0,i.jsx)(g.Z,{variant:"subtitle1",children:"T\xecm kiếm n\xe2ng cao"})}),(0,i.jsxs)(u.ZP,{container:!0,spacing:2,children:[(0,i.jsx)(u.ZP,{item:!0,xs:12,md:2,py:0,children:(0,i.jsx)(v.Z,{size:"small",fullWidth:!0,options:eu,getOptionLabel:e=>e.tenTCCN,value:eu.find(e=>e.id===ei.tochuc_canhan)||null,onChange:(e,l)=>{ef(null==l?void 0:l.id,"tochuc_canhan")},clearOnEscape:!0,renderInput:e=>(0,i.jsx)(c.Z,{...e,label:"TC/C\xe1 nh\xe2n được CP",variant:"outlined"})})}),(0,i.jsx)(u.ZP,{item:!0,xs:12,md:2,py:0,children:(0,i.jsx)(v.Z,{size:"small",fullWidth:!0,options:er,getOptionLabel:e=>e.tenHuyen,value:er.find(e=>e.idHuyen===ei.huyen)||null,onChange:(e,l)=>{ef(null==l?void 0:l.idHuyen,"huyen")},clearOnEscape:!0,renderInput:e=>(0,i.jsx)(c.Z,{...e,label:"Huyện",variant:"outlined"})})}),(0,i.jsx)(u.ZP,{item:!0,xs:12,md:2,py:0,children:(0,i.jsx)(v.Z,{size:"small",disabled:0>=Number(ei.huyen),fullWidth:!0,options:ep,getOptionLabel:e=>e.tenXa,value:ep.find(e=>e.idXa===ei.xa)||null,onChange:(e,l)=>{ef(null==l?void 0:l.idXa,"xa")},clearOnEscape:!0,renderInput:e=>(0,i.jsx)(c.Z,{...e,label:"X\xe3",variant:"outlined"})})}),(0,i.jsx)(u.ZP,{item:!0,xs:12,md:2,py:0,children:(0,i.jsx)(v.Z,{size:"small",fullWidth:!0,options:em,getOptionLabel:e=>e.tieuVungQuyHoach,value:em.find(e=>e.id===ei.tieuvung_qh)||null,onChange:(e,l)=>{ef(null==l?void 0:l.id,"tieuvung_qh")},clearOnEscape:!0,renderInput:e=>(0,i.jsx)(c.Z,{...e,label:"Tiểu v\xf9ng quy hoạch",variant:"outlined"})})}),(0,i.jsx)(u.ZP,{item:!0,xs:12,md:2,py:0,children:(0,i.jsx)(P._,{dateAdapter:N.y,children:(0,i.jsx)(T.M,{label:"Từ năm",views:["year"],value:L()(new Date(Number(ei.tu_nam),1,1)),onChange:e=>ef(e.year(),"tu_nam"),slotProps:{textField:{size:"small",fullWidth:!0,required:!0}}})})}),(0,i.jsx)(u.ZP,{item:!0,xs:12,md:2,py:0,children:(0,i.jsx)(P._,{dateAdapter:N.y,children:(0,i.jsx)(T.M,{label:"Đến năm",views:["year"],value:L()(new Date(Number(ei.den_nam),1,1)),onChange:e=>ef(e.year(),"den_nam"),slotProps:{textField:{size:"small",fullWidth:!0,required:!0}}})})})]})]})})}),(0,i.jsx)(u.ZP,{item:!0,xs:6,md:1.5,children:(0,i.jsx)(y.Z,{type:"submit",variant:"outlined",size:"small",fullWidth:!0,startIcon:(0,i.jsx)(a.Z,{}),children:"T\xecm kiếm"})}),(0,i.jsx)(u.ZP,{item:!0,xs:6,md:1.5,children:(0,i.jsx)(y.Z,{variant:"outlined",size:"small",fullWidth:!0,startIcon:(0,i.jsx)(t.Z,{}),onClick:()=>{ea(en),J.push({pathname:J.pathname,query:en},void 0,{shallow:!0}).then(()=>{null==X||X(en)})},children:"Tải lại"})}),(0,i.jsx)(u.ZP,{item:!0,xs:6,md:1.5,children:(0,i.jsx)(y.Z,{variant:"outlined",size:"small",fullWidth:!0,startIcon:(0,i.jsx)(s.Z,{}),onClick:()=>{el(e=>!e)},children:"Bộ lọc"})}),(null==R?void 0:R.id)&&(null==R?void 0:R.fileName)&&(0,i.jsx)(u.ZP,{item:!0,xs:6,md:1.5,children:(0,i.jsx)(S.Z,{tableId:R.id,filename:R.fileName})}),((null==ev?void 0:ev.CREATE)&&(null===(F=J.query)||void 0===F?void 0:F.type)==="nuoc-mat"||(null===(K=J.query)||void 0===K?void 0:K.type)==="ktsd-nuoc-duoi-dat"||(null===(E=J.query)||void 0===E?void 0:E.type)==="td-nuoc-duoi-dat"||(null===(Y=J.query)||void 0===Y?void 0:Y.type)==="hnk-nuoc-duoi-dat"||(null===(O=J.query)||void 0===O?void 0:O.type)==="xa-thai")&&(0,i.jsxs)(u.ZP,{item:!0,xs:6,md:1.5,children:[(0,i.jsx)(y.Z,{className:"tableActionBtn",onClick:()=>setTimeout(()=>{var e;return null===(e=$.current)||void 0===e?void 0:e.handleOpenDialog("create")},100),variant:"outlined",size:"small",fullWidth:!0,startIcon:(0,i.jsx)(o.Z,{}),children:"Th\xeam mới"}),(0,i.jsx)(f.Z,{ref:$,setPostSuccess:()=>{null==X||X(ei,!0)}})]})]})})})}}}]);
"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6439],{95639:function(e,t,n){var s=n(64836);t.Z=void 0;var a=s(n(33651)),i=n(85893);t.Z=(0,a.default)((0,i.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close")},98297:function(e,t,n){var s=n(13077),a=n(85893);t.Z=(0,s.Z)([(0,a.jsx)("path",{d:"M17 11c.34 0 .67.04 1 .09V6.27L10.5 3 3 6.27v4.91c0 4.54 3.2 8.79 7.5 9.82.55-.13 1.08-.32 1.6-.55-.69-.98-1.1-2.17-1.1-3.45 0-3.31 2.69-6 6-6"},"0"),(0,a.jsx)("path",{d:"M17 13c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4m0 1.38c.62 0 1.12.51 1.12 1.12s-.51 1.12-1.12 1.12-1.12-.51-1.12-1.12.5-1.12 1.12-1.12m0 5.37c-.93 0-1.74-.46-2.24-1.17.05-.72 1.51-1.08 2.24-1.08s2.19.36 2.24 1.08c-.5.71-1.31 1.17-2.24 1.17"},"1")],"AdminPanelSettings")},60018:function(e,t,n){var s=n(13077),a=n(85893);t.Z=(0,s.Z)((0,a.jsx)("path",{d:"M3 13h8V3H3zm0 8h8v-6H3zm10 0h8V11h-8zm0-18v6h8V3z"}),"Dashboard")},55201:function(e,t,n){var s=n(13077),a=n(85893);t.Z=(0,s.Z)((0,a.jsx)("path",{d:"M3 10h11v2H3zm0-2h11V6H3zm0 8h7v-2H3zm15.01-3.13.71-.71c.39-.39 1.02-.39 1.41 0l.71.71c.39.39.39 1.02 0 1.41l-.71.71zm-.71.71-5.3 5.3V21h2.12l5.3-5.3z"}),"EditNote")},73837:function(e,t,n){var s=n(13077),a=n(85893);t.Z=(0,s.Z)((0,a.jsx)("path",{d:"m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}),"ExpandLess")},85413:function(e,t,n){var s=n(13077),a=n(85893);t.Z=(0,s.Z)((0,a.jsx)("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore")},12344:function(e,t,n){var s=n(13077),a=n(85893);t.Z=(0,s.Z)((0,a.jsx)("path",{d:"M18 4H6v2l6.5 6L6 18v2h12v-3h-7l5-5-5-5h7z"}),"Functions")},11825:function(e,t,n){var s=n(13077),a=n(85893);t.Z=(0,s.Z)((0,a.jsx)("path",{d:"M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5"}),"Link")},44879:function(e,t,n){var s=n(13077),a=n(85893);t.Z=(0,s.Z)([(0,a.jsx)("path",{d:"M21 5c-1.11-.35-2.33-.5-3.5-.5-1.95 0-4.05.4-5.5 1.5-1.45-1.1-3.55-1.5-5.5-1.5S2.45 4.9 1 6v14.65c0 .25.25.5.5.5.1 0 .15-.05.25-.05C3.1 20.45 5.05 20 6.5 20c1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.3 4.75 1.05.1.05.15.05.25.05.25 0 .5-.25.5-.5V6c-.6-.45-1.25-.75-2-1m0 13.5c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V8c1.35-.85 3.8-1.5 5.5-1.5 1.2 0 2.4.15 3.5.5z"},"0"),(0,a.jsx)("path",{d:"M17.5 10.5c.88 0 1.73.09 2.5.26V9.24c-.79-.15-1.64-.24-2.5-.24-1.7 0-3.24.29-4.5.83v1.66c1.13-.64 2.7-.99 4.5-.99M13 12.49v1.66c1.13-.64 2.7-.99 4.5-.99.88 0 1.73.09 2.5.26V11.9c-.79-.15-1.64-.24-2.5-.24-1.7 0-3.24.3-4.5.83m4.5 1.84c-1.7 0-3.24.29-4.5.83v1.66c1.13-.64 2.7-.99 4.5-.99.88 0 1.73.09 2.5.26v-1.52c-.79-.16-1.64-.24-2.5-.24"},"1")],"MenuBook")},68963:function(e,t,n){var s=n(13077),a=n(85893);t.Z=(0,s.Z)((0,a.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"}),"Save")},89618:function(e,t,n){var s=n(13077),a=n(85893);t.Z=(0,s.Z)((0,a.jsx)("path",{d:"M12 1 3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11z"}),"Security")},71919:function(e,t,n){n.d(t,{Z:function(){return g}});var s=n(87462),a=n(63366),i=n(67294),r=n(8780),l=n(94780),o=n(77527),c=n(44001),d=n(1588),h=n(34867);function u(e){return(0,h.ZP)("MuiCardContent",e)}(0,d.Z)("MuiCardContent",["root"]);var m=n(85893);let x=["className","component"],p=e=>{let{classes:t}=e;return(0,l.Z)({root:["root"]},u,t)},Z=(0,o.ZP)("div",{name:"MuiCardContent",slot:"Root",overridesResolver:(e,t)=>t.root})(()=>({padding:16,"&:last-child":{paddingBottom:24}}));var g=i.forwardRef(function(e,t){let n=(0,c.i)({props:e,name:"MuiCardContent"}),{className:i,component:l="div"}=n,o=(0,a.Z)(n,x),d=(0,s.Z)({},n,{component:l}),h=p(d);return(0,m.jsx)(Z,(0,s.Z)({as:l,className:(0,r.Z)(h.root,i),ownerState:d,ref:t},o))})},34375:function(e,t,n){n.d(t,{Z:function(){return b}});var s=n(63366),a=n(87462),i=n(67294),r=n(8780),l=n(94780),o=n(96788),c=n(44001),d=n(77527),h=n(1588),u=n(34867);function m(e){return(0,u.ZP)("MuiCardHeader",e)}let x=(0,h.Z)("MuiCardHeader",["root","avatar","action","content","title","subheader"]);var p=n(85893);let Z=["action","avatar","className","component","disableTypography","subheader","subheaderTypographyProps","title","titleTypographyProps"],g=e=>{let{classes:t}=e;return(0,l.Z)({root:["root"],avatar:["avatar"],action:["action"],content:["content"],title:["title"],subheader:["subheader"]},m,t)},j=(0,d.ZP)("div",{name:"MuiCardHeader",slot:"Root",overridesResolver:(e,t)=>(0,a.Z)({["& .".concat(x.title)]:t.title,["& .".concat(x.subheader)]:t.subheader},t.root)})({display:"flex",alignItems:"center",padding:16}),f=(0,d.ZP)("div",{name:"MuiCardHeader",slot:"Avatar",overridesResolver:(e,t)=>t.avatar})({display:"flex",flex:"0 0 auto",marginRight:16}),v=(0,d.ZP)("div",{name:"MuiCardHeader",slot:"Action",overridesResolver:(e,t)=>t.action})({flex:"0 0 auto",alignSelf:"flex-start",marginTop:-4,marginRight:-8,marginBottom:-4}),y=(0,d.ZP)("div",{name:"MuiCardHeader",slot:"Content",overridesResolver:(e,t)=>t.content})({flex:"1 1 auto"});var b=i.forwardRef(function(e,t){let n=(0,c.i)({props:e,name:"MuiCardHeader"}),{action:i,avatar:l,className:d,component:h="div",disableTypography:u=!1,subheader:m,subheaderTypographyProps:x,title:b,titleTypographyProps:C}=n,S=(0,s.Z)(n,Z),w=(0,a.Z)({},n,{component:h,disableTypography:u}),z=g(w),k=b;null==k||k.type===o.Z||u||(k=(0,p.jsx)(o.Z,(0,a.Z)({variant:l?"body2":"h5",className:z.title,component:"span",display:"block"},C,{children:k})));let M=m;return null==M||M.type===o.Z||u||(M=(0,p.jsx)(o.Z,(0,a.Z)({variant:l?"body2":"body1",className:z.subheader,color:"text.secondary",component:"span",display:"block"},x,{children:M}))),(0,p.jsxs)(j,(0,a.Z)({className:(0,r.Z)(z.root,d),as:h,ref:t,ownerState:w},S,{children:[l&&(0,p.jsx)(f,{className:z.avatar,ownerState:w,children:l}),(0,p.jsxs)(y,{className:z.content,ownerState:w,children:[k,M]}),i&&(0,p.jsx)(v,{className:z.action,ownerState:w,children:i})]}))})},92365:function(e,t,n){var s=n(87462),a=n(63366),i=n(67294),r=n(8780),l=n(94780),o=n(96788),c=n(77527),d=n(44001),h=n(67184),u=n(8984),m=n(85893);let x=["className","id"],p=e=>{let{classes:t}=e;return(0,l.Z)({root:["root"]},h.a,t)},Z=(0,c.ZP)(o.Z,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(e,t)=>t.root})({padding:"16px 24px",flex:"0 0 auto"}),g=i.forwardRef(function(e,t){let n=(0,d.i)({props:e,name:"MuiDialogTitle"}),{className:l,id:o}=n,c=(0,a.Z)(n,x),h=p(n),{titleId:g=o}=i.useContext(u.Z);return(0,m.jsx)(Z,(0,s.Z)({component:"h2",className:(0,r.Z)(h.root,l),ownerState:n,ref:t,variant:"h6",id:null!=o?o:g},c))});t.Z=g},68431:function(e,t,n){var s=n(85893);n(67294);var a=n(88196),i=n(92365),r=n(40110),l=n(44723),o=n(96788),c=n(96727),d=n(51015),h=n(97182);t.Z=e=>{let{open:t,onClose:n,onConfirm:u,title:m,itemName:x,itemType:p,loading:Z,error:g,success:j,warningMessage:f}=e;return(0,s.jsxs)(a.Z,{open:t,onClose:Z?void 0:n,children:[(0,s.jsx)(i.Z,{children:m}),(0,s.jsxs)(r.Z,{children:[g&&(0,s.jsx)(l.Z,{severity:"error",sx:{mb:2},children:g}),j&&(0,s.jsxs)(l.Z,{severity:"success",sx:{mb:2},children:["X\xf3a ",p.toLowerCase()," th\xe0nh c\xf4ng!"]}),(0,s.jsxs)(o.Z,{children:["Bạn c\xf3 chắc chắn muốn x\xf3a ",p.toLowerCase()," ",(0,s.jsx)("strong",{children:x}),"?"]}),(0,s.jsx)(o.Z,{color:"error",variant:"body2",sx:{mt:1},children:f||"Lưu \xfd: H\xe0nh động n\xe0y kh\xf4ng thể ho\xe0n t\xe1c."})]}),(0,s.jsxs)(c.Z,{children:[(0,s.jsx)(d.Z,{onClick:n,disabled:Z,children:"Hủy"}),(0,s.jsx)(d.Z,{variant:"contained",color:"error",onClick:u,disabled:Z||j,startIcon:Z&&(0,s.jsx)(h.Z,{size:16,color:"inherit"}),children:Z?"Đang x\xf3a...":"X\xe1c nhận x\xf3a"})]})]})}},38138:function(e,t,n){var s=n(85893),a=n(67294),i=n(75486),r=n(84166),l=n(88196),o=n(36795),c=n(88539),d=n(96788),h=n(51015),u=n(40110),m=n(95639);let x=a.forwardRef(function(e,t){return(0,s.jsx)(i.Z,{direction:"left",ref:t,...e})});t.Z=e=>{let{children:t}=e,[n,i]=(0,a.useState)(null),[p,Z]=(0,a.useState)(null),[g,j]=(0,a.useState)(!1),f=()=>{i(null),Z(null),j(!1)};return(0,s.jsxs)(r.Z,{children:[t((e,t)=>{i(e),Z(t),j(!0)},f),(0,s.jsx)(l.Z,{open:g,onClose:f,fullScreen:!0,TransitionComponent:x,sx:{zIndex:1201},children:n&&(0,s.jsxs)(r.Z,{children:[(0,s.jsx)(o.Z,{sx:{position:"relative"},children:(0,s.jsxs)(c.Z,{sx:{maxHeight:45,minHeight:45,position:"sticky",top:0},children:[(0,s.jsx)(d.Z,{sx:{ml:2,flex:1,color:"#fff"},variant:"h6",component:"div",children:p}),(0,s.jsx)(h.Z,{className:"btn closeBtn",sx:{p:2,mr:-2},onClick:f,children:(0,s.jsx)(m.Z,{})})]})}),(0,s.jsx)(u.Z,{children:n})]})})]})}},76598:function(e,t,n){n.d(t,{Z:function(){return i}});var s=n(67294),a=n(21565);let i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{pauseGlobalLoading:!0},[t,n]=(0,s.useState)(!1),{pauseGlobalLoading:i,resumeGlobalLoading:r}=(0,a.r)();return(0,s.useEffect)(()=>(e.pauseGlobalLoading&&i(),()=>{e.pauseGlobalLoading&&r()}),[e.pauseGlobalLoading,i,r]),{isSubmitting:t,submitForm:async e=>{n(!0);try{return await e()}finally{n(!1)}}}}},86439:function(e,t,n){n.r(t),n.d(t,{default:function(){return eo}});var s=n(85893),a=n(67294),i=n(60990),r=n(81873),l=n(96788),o=n(60762),c=n(40492),d=n(95611),h=n(21038),u=n(52857),m=n(51015),x=n(56912),p=n(44723),Z=n(97182),g=n(98297),j=n(38855),f=n(83947),v=n(53839),y=n(89090),b=n(77527),C=n(64577),S=n(39892),w=n(68431),z=n(13754),k=n(88196),M=n(92365),L=n(40110),N=n(68573),P=n(65806),I=n(12166),T=n(96727),H=n(55201),R=(0,n(13077).Z)((0,s.jsx)("path",{d:"M13 8c0-2.21-1.79-4-4-4S5 5.79 5 8s1.79 4 4 4 4-1.79 4-4m-2 0c0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2 2 .9 2 2M1 18v2h16v-2c0-2.66-5.33-4-8-4s-8 1.34-8 4m2 0c.2-.71 3.3-2 6-2 2.69 0 5.78 1.28 6 2zm17-3v-3h3v-2h-3V7h-2v3h-3v2h3v3z"}),"PersonAddAlt"),D=n(68963),E=n(76598),V=e=>{let{data:t,isEdit:n,children:r,setPostSuccess:l}=e,[o,d]=(0,a.useState)(!1),[x,g]=(0,a.useState)({id:(null==t?void 0:t.id)||"",name:(null==t?void 0:t.name)||"",isDefault:(null==t?void 0:t.isDefault)||!1,description:(null==t?void 0:t.description)||""}),{isSubmitting:j,submitForm:f}=(0,E.Z)(),{success:v}=(0,z.l)(),[y,b]=(0,a.useState)(null);(0,a.useEffect)(()=>{t&&g({id:t.id||"",name:t.name||"",isDefault:t.isDefault||!1,description:t.description||""})},[t]);let S=e=>t=>{let n="checkbox"===t.target.type?t.target.checked:t.target.value;g({...x,[e]:n})},w=async e=>{if(e.preventDefault(),b(null),!x.name){b("T\xean nh\xf3m người d\xf9ng kh\xf4ng được để trống");return}await f(async()=>{try{let e=!1;if(x.id?(e=await C.authService.updateRole(x,!1))&&v("Cập nhật nh\xf3m người d\xf9ng th\xe0nh c\xf4ng"):(e=await C.authService.createRole(x,!1))&&v("Tạo nh\xf3m người d\xf9ng th\xe0nh c\xf4ng"),e)return setTimeout(()=>{l(!0),A()},1e3),!0;return b("Kh\xf4ng thể lưu nh\xf3m người d\xf9ng. Vui l\xf2ng thử lại."),!1}catch(e){return console.error(e),b(e.message||"C\xf3 lỗi xảy ra khi xử l\xfd y\xeau cầu"),!1}})},V=()=>{n||g({id:"",name:"",isDefault:!1,description:""}),d(!0)},A=()=>{d(!1),b(null)},q=n?"Chỉnh sửa nh\xf3m người d\xf9ng":"Th\xeam nh\xf3m người d\xf9ng mới";return(0,s.jsxs)(s.Fragment,{children:[r?(0,s.jsx)(i.Z,{onClick:V,sx:{display:"inline-flex"},children:r}):(0,s.jsx)(h.Z,{title:q,children:(0,s.jsx)(u.Z,{className:"tableActionBtn",onClick:V,children:n?(0,s.jsx)(H.Z,{fontSize:"small"}):(0,s.jsx)(R,{fontSize:"small"})})}),(0,s.jsxs)(k.Z,{open:o,onClose:A,maxWidth:"sm",fullWidth:!0,children:[(0,s.jsx)(M.Z,{children:q}),(0,s.jsxs)("form",{onSubmit:w,children:[(0,s.jsxs)(L.Z,{children:[y&&(0,s.jsx)(p.Z,{severity:"error",sx:{mb:2},children:y}),(0,s.jsxs)(N.ZP,{container:!0,spacing:2,children:[(0,s.jsx)(N.ZP,{item:!0,xs:12,children:(0,s.jsx)(c.Z,{fullWidth:!0,size:"small",label:"T\xean nh\xf3m người d\xf9ng",placeholder:"Nhập t\xean nh\xf3m người d\xf9ng",value:x.name,onChange:S("name"),required:!0,error:!!y&&!x.name,helperText:y&&!x.name?"T\xean nh\xf3m người d\xf9ng kh\xf4ng được để trống":"",autoComplete:"off",margin:"normal"})}),(0,s.jsx)(N.ZP,{item:!0,xs:12,children:(0,s.jsx)(c.Z,{fullWidth:!0,size:"small",label:"M\xf4 tả",placeholder:"Nhập m\xf4 tả (kh\xf4ng bắt buộc)",value:x.description,onChange:S("description"),autoComplete:"off",multiline:!0,rows:2,margin:"normal"})}),(0,s.jsx)(N.ZP,{item:!0,xs:12,children:(0,s.jsx)(P.Z,{control:(0,s.jsx)(I.Z,{checked:x.isDefault,onChange:S("isDefault"),color:"primary"}),label:"Đặt l\xe0m nh\xf3m mặc định"})})]})]}),(0,s.jsxs)(T.Z,{children:[(0,s.jsx)(m.Z,{onClick:A,color:"inherit",disabled:j,children:"Hủy"}),(0,s.jsx)(m.Z,{type:"submit",variant:"contained",color:"primary",disabled:j||!x.name,startIcon:j?(0,s.jsx)(Z.Z,{size:20,color:"inherit"}):(0,s.jsx)(D.Z,{}),children:j?"Đang lưu...":"Lưu"})]})]})]})]})},A=n(93454),q=n(84166),W=n(29437),B=n(24772),K=n(11825),G=n(60018),X=n(38138);let _=e=>{let{data:t}=e,[n,o]=(0,a.useState)([]),[m,g]=(0,a.useState)([]),[v,y]=(0,a.useState)(""),[b,w]=(0,a.useState)(!1),[k,M]=(0,a.useState)(!1),[L,N]=(0,a.useState)({}),[I,T]=(0,a.useState)(null),[H,R]=(0,a.useState)(null),[D,V]=(0,a.useState)(!1),{submitForm:G}=(0,E.Z)(),{success:X,error:_}=(0,z.l)(),F=()=>{w(e=>!e)};(0,a.useEffect)(()=>{if(!v.trim()&&!D){g(n);return}let e=[...n];v.trim()&&(e=e.filter(e=>e.dashboardName.toLowerCase().includes(v.toLowerCase())||e.fileControl.toLowerCase().includes(v.toLowerCase()))),D&&(e=e.filter(e=>e.permitAccess)),g(e)},[v,D,n]);let Q=(0,a.useCallback)(async()=>{try{M(!0),T(null);let e=await C.authService.getDashboardsByRole(t.name);o(e),g(e)}catch(t){console.error("Error fetching dashboards:",t);let e="Kh\xf4ng thể tải dữ liệu trang truy cập. Vui l\xf2ng thử lại sau.";T(e),_(e),o([]),g([])}finally{M(!1)}},[t.name]);(0,a.useEffect)(()=>{Q()},[Q,b]);let O=e=>async()=>{let n=e.permitAccess,s=e.id.toString(),a={id:e.id||0,roleId:t.id,roleName:t.name,dashboardId:e.dashboardId,fileControl:e.fileControl,permitAccess:!n};N(e=>({...e,[s]:!0})),await G(async()=>{try{if(T(null),R(null),n){await C.authService.removeRoleDashboardAccess(a);let t="Đ\xe3 thu hồi quyền truy cập trang ".concat(e.dashboardName);R(t),X(t)}else{await C.authService.assignRoleDashboardAccess(a);let t="Đ\xe3 cấp quyền truy cập trang ".concat(e.dashboardName);R(t),X(t)}return o(t=>t.map(t=>t.id===e.id?{...t,permitAccess:!n}:t)),!0}catch(t){console.error("Error toggling permission:",t);let e="Kh\xf4ng thể thay đổi quyền truy cập. Vui l\xf2ng thử lại sau.";return T(e),_(e),!1}finally{N(e=>({...e,[s]:!1})),H&&setTimeout(()=>R(null),3e3)}}),setTimeout(()=>{Q(),F()},500)};return(0,s.jsxs)(i.Z,{sx:{p:2},children:[(0,s.jsx)(()=>(0,s.jsx)(A.Z,{variant:"outlined",sx:{p:3,mb:3},children:(0,s.jsxs)(q.Z,{direction:"row",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",spacing:2,children:[(0,s.jsxs)(i.Z,{children:[(0,s.jsxs)(l.Z,{variant:"h6",gutterBottom:!0,children:[t.name,t.isDefault&&(0,s.jsx)(r.Z,{size:"small",label:"Mặc định",color:"primary",variant:"outlined",sx:{ml:1}})]}),(0,s.jsx)(l.Z,{variant:"body2",color:"text.secondary",children:t.description||"Chưa c\xf3 m\xf4 tả"})]}),(0,s.jsx)(r.Z,{icon:(0,s.jsx)(B.Z,{fontSize:"small"}),label:"".concat(n.length," trang"),color:"primary"})]})}),{}),I&&(0,s.jsx)(p.Z,{severity:"error",sx:{mb:3},onClose:()=>T(null),children:I}),H&&(0,s.jsx)(p.Z,{severity:"success",sx:{mb:3},onClose:()=>R(null),children:H}),(0,s.jsxs)(i.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,flexWrap:"wrap",gap:2},children:[(0,s.jsx)(c.Z,{size:"small",placeholder:"T\xecm kiếm trang...",value:v,onChange:e=>y(e.target.value),InputProps:{startAdornment:(0,s.jsx)(d.Z,{position:"start",children:(0,s.jsx)(j.Z,{fontSize:"small"})})},sx:{minWidth:{xs:"100%",sm:300}},autoComplete:"off"}),(0,s.jsxs)(i.Z,{sx:{display:"flex",gap:1},children:[(0,s.jsx)(h.Z,{title:"Chỉ hiển thị trang đ\xe3 cấp quyền",children:(0,s.jsx)(P.Z,{control:(0,s.jsx)(W.Z,{checked:D,onChange:e=>V(e.target.checked),size:"small"}),label:"Đ\xe3 cấp quyền"})}),(0,s.jsx)(h.Z,{title:"L\xe0m mới",children:(0,s.jsx)(u.Z,{onClick:()=>{Q(),X("Dữ liệu đ\xe3 được cập nhật")},disabled:k,color:"primary",children:(0,s.jsx)(f.Z,{})})})]})]}),(0,s.jsx)(x.Z,{sx:{mb:2}}),(0,s.jsx)(S.Z,{columns:[{id:"dashboardName",label:"T\xean trang",elm:e=>(0,s.jsx)(l.Z,{variant:"body1",fontWeight:500,children:e.dashboardName})},{id:"fileControl",label:"URL",elm:e=>(0,s.jsxs)(l.Z,{variant:"body2",sx:{display:"flex",alignItems:"center"},children:[(0,s.jsx)(K.Z,{fontSize:"small",color:"action",sx:{mr:.5}}),e.fileControl]})},{id:"permitAccess",label:"Truy cập",elm:e=>{let t=L[e.id.toString()],n=!!(null==e?void 0:e.permitAccess);return(0,s.jsx)(i.Z,{sx:{display:"flex",justifyContent:"center"},children:t?(0,s.jsx)(Z.Z,{size:24}):(0,s.jsx)(W.Z,{checked:n,onChange:O(e),color:n?"primary":"default",inputProps:{"aria-label":"toggle permission"}})})}}],loading:k,rows:m,pagination:!0})]})};var F=e=>{let{data:t}=e,n="Quản l\xfd quyền truy cập trang - ".concat(null==t?void 0:t.name);return(0,s.jsx)(X.Z,{children:(e,a)=>(0,s.jsx)(h.Z,{title:n,children:(0,s.jsx)(u.Z,{color:"primary",size:"small",onClick:()=>e((0,s.jsx)(_,{data:t,closeDialogs:a}),n),children:(0,s.jsx)(G.Z,{fontSize:"small"})})})})},Q=n(34375),O=n(4291),U=n(71919),J=n(44879),Y=n(89618),$=n(73837),ee=n(85413),et=n(12344);let en=e=>{let{data:t}=e,[n,m]=(0,a.useState)([]),[g,v]=(0,a.useState)([]),[y,b]=(0,a.useState)(!1),[S,w]=(0,a.useState)({}),[k,M]=(0,a.useState)(""),[L,T]=(0,a.useState)(null),[H,R]=(0,a.useState)(null),[D,V]=(0,a.useState)({}),{submitForm:W}=(0,E.Z)(),{success:B,error:K}=(0,z.l)(),G=e=>{V(t=>({...t,[e]:!t[e]}))};(0,a.useEffect)(()=>{if(!k.trim()){v(n);return}let e=n.filter(e=>e.name.toLowerCase().includes(k.toLowerCase())||e.path.toLowerCase().includes(k.toLowerCase())||e.functions.some(e=>e.permitName.toLowerCase().includes(k.toLowerCase())));if(k.trim()){let t={...D};e.forEach(e=>{t[e.id]=!0}),V(t)}v(e)},[k,n]);let X=(0,a.useCallback)(async()=>{try{b(!0),T(null);let e=await C.authService.getRoleById(t.id);if(null==e?void 0:e.dashboards){let t=e.dashboards.map(e=>({...e,functions:(e.functions||[]).map(e=>({id:e.id,permitCode:e.permitCode||"",permitName:e.permitName||"",status:e.status}))}));m(t),console.log(t),v(t);let n={};t.forEach(e=>{e.functions.some(e=>e.status)&&(n[e.id]=!0)}),V(n)}else m([]),v([])}catch(t){console.error("Error fetching role data:",t);let e="Kh\xf4ng thể tải dữ liệu chức năng. Vui l\xf2ng thử lại sau.";T(e),K(e),m([]),v([])}finally{b(!1)}},[t.id]);(0,a.useEffect)(()=>{X()},[X]);let _=(e,n)=>async()=>{let s="".concat(n.id,"-").concat(e.id),a={roleId:t.id,dashboardId:n.id,functionId:e.id,functionName:e.permitName,functionCode:e.permitCode};w(e=>({...e,[s]:!0})),await W(async()=>{try{if(T(null),R(null),e.status){await C.authService.deletePermission(a,!1);let s="Đ\xe3 thu hồi quyền ".concat(e.permitName," tr\xean trang ").concat(n.name," cho vai tr\xf2 ").concat(t.name);R(s),B(s)}else{await C.authService.savePermission(a,!1);let s="Đ\xe3 cấp quyền ".concat(e.permitName," tr\xean trang ").concat(n.name," cho vai tr\xf2 ").concat(t.name);R(s),B(s)}return m(t=>t.map(t=>t.id===n.id?{...t,functions:t.functions.map(t=>t.id===e.id?{...t,status:!t.status}:t)}:t)),!0}catch(t){console.error("Error toggling function permission:",t);let e="Kh\xf4ng thể thay đổi quyền chức năng";return T(e),K(e),!1}finally{w(e=>({...e,[s]:!1}))}}),setTimeout(()=>{X()},500)};return(0,s.jsxs)(i.Z,{sx:{p:2},children:[(0,s.jsx)(()=>(0,s.jsx)(A.Z,{variant:"outlined",sx:{p:3,mb:3},children:(0,s.jsxs)(q.Z,{direction:"row",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",spacing:2,children:[(0,s.jsxs)(i.Z,{children:[(0,s.jsxs)(l.Z,{variant:"h6",gutterBottom:!0,children:[t.name,t.isDefault&&(0,s.jsx)(r.Z,{size:"small",label:"Mặc định",color:"primary",variant:"outlined",sx:{ml:1}})]}),(0,s.jsx)(l.Z,{variant:"body2",color:"text.secondary",children:t.description||"Chưa c\xf3 m\xf4 tả"})]}),(0,s.jsxs)(q.Z,{direction:"row",spacing:1,children:[(0,s.jsx)(r.Z,{icon:(0,s.jsx)(J.Z,{fontSize:"small"}),label:"".concat(n.length," trang"),color:"primary"}),(0,s.jsx)(r.Z,{icon:(0,s.jsx)(Y.Z,{fontSize:"small"}),label:"".concat(n.reduce((e,t)=>e+t.functions.filter(e=>e.status).length,0)," quyền hoạt động"),color:"secondary"})]})]})}),{}),L&&(0,s.jsx)(p.Z,{severity:"error",sx:{mb:3},onClose:()=>T(null),children:L}),H&&(0,s.jsx)(p.Z,{severity:"success",sx:{mb:3},onClose:()=>R(null),children:H}),(0,s.jsxs)(i.Z,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,s.jsx)(c.Z,{size:"small",placeholder:"T\xecm kiếm chức năng...",value:k,onChange:e=>M(e.target.value),InputProps:{startAdornment:(0,s.jsx)(d.Z,{position:"start",children:(0,s.jsx)(j.Z,{fontSize:"small"})})},sx:{minWidth:{xs:"100%",sm:300}},autoComplete:"off"}),(0,s.jsx)(h.Z,{title:"L\xe0m mới",children:(0,s.jsx)(u.Z,{onClick:()=>{X(),B("Dữ liệu đ\xe3 được cập nhật")},disabled:y,color:"primary",children:(0,s.jsx)(f.Z,{})})})]}),(0,s.jsx)(x.Z,{sx:{mb:3}}),y&&(0,s.jsx)(i.Z,{sx:{display:"flex",justifyContent:"center",py:5},children:(0,s.jsx)(Z.Z,{})}),!y&&0===g.length&&(0,s.jsxs)(i.Z,{sx:{textAlign:"center",py:5},children:[(0,s.jsx)(Y.Z,{sx:{fontSize:"3rem",color:"text.secondary",opacity:.6,mb:2}}),(0,s.jsx)(l.Z,{variant:"h6",gutterBottom:!0,children:k?"Kh\xf4ng t\xecm thấy chức năng n\xe0o ph\xf9 hợp":"Chưa c\xf3 chức năng n\xe0o"}),(0,s.jsx)(l.Z,{variant:"body2",color:"text.secondary",children:k?'Kh\xf4ng t\xecm thấy kết quả cho "'.concat(k,'"'):"H\xe3y th\xeam trang v\xe0 chức năng mới v\xe0o hệ thống"})]}),!y&&g.map(e=>(0,s.jsxs)(o.Z,{sx:{mb:2},children:[(0,s.jsx)(Q.Z,{title:(0,s.jsxs)(i.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,s.jsx)(J.Z,{sx:{mr:1,color:"primary.main"}}),(0,s.jsx)(l.Z,{variant:"h6",children:e.name})]}),subheader:e.path,action:(0,s.jsx)(u.Z,{onClick:()=>G(e.id),children:D[e.id]?(0,s.jsx)($.Z,{}):(0,s.jsx)(ee.Z,{})}),onClick:()=>G(e.id),sx:{cursor:"pointer"}}),(0,s.jsx)(O.Z,{in:D[e.id],timeout:"auto",unmountOnExit:!0,children:(0,s.jsxs)(U.Z,{children:[(0,s.jsx)(l.Z,{variant:"subtitle2",gutterBottom:!0,children:"C\xe1c chức năng của trang:"}),(0,s.jsx)(N.ZP,{container:!0,spacing:2,children:e.functions.map(t=>{let n=S["".concat(t.id)];return(0,s.jsx)(N.ZP,{item:!0,xs:12,sm:6,md:4,children:(0,s.jsx)(A.Z,{variant:"outlined",sx:{p:1,display:"flex",justifyContent:"space-between",alignItems:"center",bgcolor:t.status?"action.selected":"background.paper"},children:(0,s.jsx)(P.Z,{control:n?(0,s.jsx)(Z.Z,{size:20}):(0,s.jsx)(I.Z,{checked:t.status,onChange:_(t,e),color:"primary"}),label:(0,s.jsxs)(i.Z,{children:[(0,s.jsx)(l.Z,{variant:"body2",children:t.permitName}),(0,s.jsx)(l.Z,{variant:"caption",color:"text.secondary",children:t.permitCode})]})})})},t.id)})})]})})]},e.id))]})};var es=e=>{let{data:t,children:n}=e,a="Quản l\xfd quyền chức năng - ".concat(t.name);return(0,s.jsx)(X.Z,{children:(e,i)=>(0,s.jsx)(h.Z,{title:a,children:(0,s.jsx)(u.Z,{color:"primary",size:"small",onClick:()=>e((0,s.jsx)(en,{data:t,closeDialogs:i}),a),sx:{cursor:"pointer"},children:n||(0,s.jsx)(et.Z,{fontSize:"small"})})})})};let ea=(0,b.ZP)(i.Z)(e=>{let{theme:t}=e;return{padding:t.spacing(3),display:"flex",justifyContent:"space-between",alignItems:"center",[t.breakpoints.down("sm")]:{flexDirection:"column",alignItems:"flex-start",gap:t.spacing(2)}}}),ei=(0,b.ZP)(i.Z)(e=>{let{theme:t}=e;return{display:"flex",alignItems:"center",gap:t.spacing(2),[t.breakpoints.down("sm")]:{width:"100%"}}}),er=(0,b.ZP)(i.Z)(e=>{let{theme:t}=e;return{display:"flex",alignItems:"center",gap:t.spacing(1),[t.breakpoints.down("sm")]:{marginTop:t.spacing(2)}}}),el=(0,b.ZP)(r.Z)(()=>({"&.MuiChip-root":{borderRadius:"4px",fontWeight:500}}));var eo=()=>{let[e,t]=(0,a.useState)(!1),[n,b]=(0,a.useState)([]),[k,M]=(0,a.useState)(!1),[L,N]=(0,a.useState)(""),[P,I]=(0,a.useState)([]),[T,H]=(0,a.useState)(null),[R,D]=(0,a.useState)(!1),[E,A]=(0,a.useState)(!1),[q,W]=(0,a.useState)(null),{success:B,error:K}=(0,z.l)(),G=()=>{t(e=>!e)};(0,a.useEffect)(()=>{(async()=>{try{M(!0),W(null);let e=await C.authService.getRoles(!1);if(e){let t=e.map(e=>({...e,id:e.id||"",name:e.name||""}));b(t),I(t)}else throw Error("Dữ liệu kh\xf4ng đ\xfang định dạng")}catch(t){let e=t.message||"Kh\xf4ng thể tải dữ liệu nh\xf3m người d\xf9ng";W(e),K(e),b([]),I([])}finally{M(!1)}})()},[e]),(0,a.useEffect)(()=>{""===L.trim()?I(n):I(n.filter(e=>e.name.toLowerCase().includes(L.toLowerCase())||e.description&&e.description.toLowerCase().includes(L.toLowerCase())))},[L,n]);let X=e=>{H(e),D(!0)},_=()=>{D(!1),setTimeout(()=>{H(null)},200)},Q=async()=>{if(T){A(!0);try{if(await C.authService.deleteRole(T.id))B('Đ\xe3 x\xf3a nh\xf3m người d\xf9ng "'.concat(T.name,'" th\xe0nh c\xf4ng')),G(),_();else throw Error("Kh\xf4ng thể x\xf3a nh\xf3m người d\xf9ng")}catch(e){K(e.message||"Kh\xf4ng thể x\xf3a nh\xf3m người d\xf9ng")}finally{A(!1)}}},O=[{id:"name",label:"T\xean nh\xf3m",width:300,elm:e=>(0,s.jsx)(i.Z,{sx:{display:"flex",alignItems:"center"},children:(0,s.jsxs)(l.Z,{fontWeight:500,children:[e.name,e.isDefault&&(0,s.jsx)(el,{label:"Mặc định",color:"primary",variant:"outlined",size:"small",sx:{ml:1}})]})})},{id:"description",label:"M\xf4 tả",elm:e=>(0,s.jsx)(l.Z,{children:e.description||"-"})},{id:"actions",label:"Thao t\xe1c",width:150}];return(0,s.jsxs)(o.Z,{children:[(0,s.jsxs)(ea,{children:[(0,s.jsxs)(l.Z,{variant:"h6",sx:{display:"flex",alignItems:"center"},children:[(0,s.jsx)(g.Z,{sx:{mr:1}}),"Quản l\xfd nh\xf3m người d\xf9ng",(0,s.jsx)(r.Z,{label:n.length,color:"primary",size:"small",sx:{ml:1}})]}),(0,s.jsxs)(ei,{children:[(0,s.jsx)(c.Z,{size:"small",placeholder:"T\xecm kiếm...",value:L,onChange:e=>N(e.target.value),InputProps:{startAdornment:(0,s.jsx)(d.Z,{position:"start",children:(0,s.jsx)(j.Z,{fontSize:"small"})})},sx:{minWidth:250},autoComplete:"off"}),(0,s.jsxs)(er,{children:[(0,s.jsx)(h.Z,{title:"L\xe0m mới",children:(0,s.jsx)(u.Z,{onClick:()=>{N(""),G(),B("Đ\xe3 l\xe0m mới dữ liệu")},color:"primary",disabled:k,children:(0,s.jsx)(f.Z,{})})}),(0,s.jsx)(V,{setPostSuccess:G,children:(0,s.jsx)(m.Z,{variant:"contained",startIcon:(0,s.jsx)(v.Z,{}),size:"small",children:"Th\xeam nh\xf3m"})})]})]})]}),(0,s.jsx)(x.Z,{}),q&&(0,s.jsx)(p.Z,{severity:"error",sx:{m:3},onClose:()=>W(null),children:q}),(0,s.jsx)(i.Z,{sx:{p:0},children:k&&0===n.length?(0,s.jsx)(i.Z,{sx:{display:"flex",justifyContent:"center",py:10},children:(0,s.jsx)(Z.Z,{})}):(0,s.jsx)(S.Z,{columns:O,rows:P,loading:k,pagination:!0,actions:e=>(0,s.jsxs)(i.Z,{sx:{display:"flex",gap:1,alignItems:"center",justifyContent:"flex-end"},children:[(0,s.jsx)(V,{data:e,isEdit:!0,setPostSuccess:G}),(0,s.jsx)(F,{data:e}),(0,s.jsx)(es,{data:e}),(0,s.jsx)(h.Z,{title:"X\xf3a",children:(0,s.jsx)(u.Z,{size:"small",color:"error",onClick:()=>X(e),disabled:null==e?void 0:e.isDefault,children:(0,s.jsx)(y.Z,{fontSize:"small"})})})]})})}),(0,s.jsx)(w.Z,{open:R,onClose:_,onConfirm:Q,loading:E,title:"X\xe1c nhận x\xf3a nh\xf3m người d\xf9ng",itemName:(null==T?void 0:T.name)||"",itemType:"nh\xf3m người d\xf9ng",warningMessage:"Lưu \xfd: Tất cả quyền v\xe0 người d\xf9ng thuộc nh\xf3m n\xe0y sẽ bị ảnh hưởng.",error:null,success:!1})]})}}}]);
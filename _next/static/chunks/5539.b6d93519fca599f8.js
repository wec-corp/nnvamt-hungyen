(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5539],{87210:function(t,e,i){"use strict";i.d(e,{S:function(){return o}});var n=i(74579);i(58954);var o=(0,n.dW)(t=>({instance:L.bingLayer(t.bingkey,t)}))},58954:function(){L.BingLayer=L.TileLayer.extend({options:{subdomains:[0,1,2,3],type:"Aerial",attribution:"Bing",culture:"",style:""},initialize:function(t,e){L.Util.setOptions(this,e),this._bing_key=t,this._url=null,this._providers=[],this.metaRequested=!1},tile2quad:function(t,e,i){for(var n="",o=i;o>0;o--){var r=0,s=1<<o-1;(t&s)!=0&&(r+=1),(e&s)!=0&&(r+=2),n+=r}return n},getTileUrl:function(t){var e=this._getZoomForUrl(),i=this.options.subdomains,n=this.options.subdomains[Math.abs((t.x+t.y)%i.length)];return this._url.replace("{subdomain}",n).replace("{quadkey}",this.tile2quad(t.x,t.y,e)).replace("{culture}",this.options.culture)},loadMetadata:function(){if(this.metaRequested)return;this.metaRequested=!0;let t=this;var e="_bing_metadata_"+L.Util.stamp(this);window[e]=function(i){window[e]=void 0;var n=document.getElementById(e);if(n.parentNode.removeChild(n),i.errorDetails){console.log(i.errorDetails);return}t.initMetadata(i)};var i="file:"===document.location.protocol?"http":document.location.protocol.slice(0,-1),n=i+"://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.options.type+"?include=ImageryProviders&jsonp="+e+"&key="+this._bing_key+"&UriScheme="+i+"&culture="+this.options.culture+"&style="+this.options.style,o=document.createElement("script");o.type="text/javascript",o.src=n,o.id=e,document.getElementsByTagName("head")[0].appendChild(o)},initMetadata:function(t){var e=t.resourceSets[0].resources[0];if(this.options.subdomains=e.imageUrlSubdomains,this._url=e.imageUrl,e.imageryProviders)for(var i=0;i<e.imageryProviders.length;i++)for(var n=e.imageryProviders[i],o=0;o<n.coverageAreas.length;o++){var r=n.coverageAreas[o],s={zoomMin:r.zoomMin,zoomMax:r.zoomMax,active:!1};if(void 0!=r.bbox)var a=new L.LatLngBounds(new L.LatLng(r.bbox[0]+.01,r.bbox[1]+.01),new L.LatLng(r.bbox[2]-.01,r.bbox[3]-.01));s.bounds=a,s.attrib=n.attribution,this._providers.push(s)}this._update()},_update:function(){null!==this._url&&this._map&&(this._update_attribution(),L.TileLayer.prototype._update.apply(this,[]))},_update_attribution:function(){for(var t=this._map.getZoom(),e=0;e<this._providers.length;e++){var i=this._providers[e];t<=i.zoomMax&&t>=i.zoomMin?(!i.active&&this._map.attributionControl&&this._map.attributionControl.addAttribution(i.attrib),i.active=!0):(i.active&&this._map.attributionControl&&this._map.attributionControl.removeAttribution(i.attrib),i.active=!1)}},onAdd:function(t){this.loadMetadata(),L.TileLayer.prototype.onAdd.apply(this,[t])},onRemove:function(t){for(var e=0;e<this._providers.length;e++){var i=this._providers[e];i.active&&this._map.attributionControl&&(this._map.attributionControl.removeAttribution(i.attrib),i.active=!1)}L.TileLayer.prototype.onRemove.apply(this,[t])}}),L.bingLayer=function(t,e){return new L.BingLayer(t,e)}},55539:function(t,e,i){"use strict";i.r(e);var n=i(85893),o=i(67294),r=i(32342),s=i(39153),a=i(5715),l=i(26467),c=i(20577),u=i(64049),d=i(32604),h=i(60990),p=i(97182),m=i(96788),f=i(87210);i(53183);var b=i(45243),g=i.n(b);let{BaseLayer:x}=r.LayersControl,v=t=>{let e;switch(t){case"serious":e="#F44336";break;case"moderate":e="#FF9800";break;default:e="#4CAF50"}return g().divIcon({className:"incident-marker incident-".concat(t),html:'<div style="width: 14px; height: 14px; border-radius: 50%; background-color: '.concat(e,'; border: 2px solid white;"></div>'),iconSize:g().point(18,18),iconAnchor:g().point(9,9),popupAnchor:g().point(0,-10)})},y=new(g()).Icon({iconUrl:"/images/icon/marker.png",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-32]}),_=t=>{let{incidents:e}=t,i=(0,s.Sx)();return(0,o.useEffect)(()=>{if(e&&e.length>0){let t=g().latLngBounds(e.map(t=>t.position));i.fitBounds(t,{padding:[50,50]})}},[e,i]),null};e.default=t=>{let{incidents:e,onSelectIncident:i}=t,[s,b]=(0,o.useState)(!0),[g]=(0,o.useState)("AuhiCJHlGzhg93IqUH_oCpl_-ZUrIE6SPftlyGYUvr9Amx5nzA-WqGcPquyFZl4L"),j=e.length>0?e[0].position:[20.675,106.081];(0,o.useEffect)(()=>{b(!1)},[]);let z=(0,o.useCallback)(t=>{i&&i(t)},[i]);return(0,n.jsx)(h.Z,{sx:{height:"100%",width:"100%",position:"relative"},children:s?(0,n.jsxs)(h.Z,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",flexDirection:"column",gap:2},children:[(0,n.jsx)(p.Z,{}),(0,n.jsx)(m.Z,{children:"Đang tải bản đồ..."})]}):(0,n.jsxs)(a.h,{center:j,zoom:11,style:{height:"100%",width:"100%"},attributionControl:!1,children:[(0,n.jsx)(_,{incidents:e}),(0,n.jsxs)(r.LayersControl,{position:"bottomright",children:[(0,n.jsx)(x,{name:"Bản đồ h\xe0nh ch\xednh",children:(0,n.jsx)(l.I,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"})}),(0,n.jsx)(x,{name:"Bản đồ đường",children:(0,n.jsx)(f.S,{bingkey:g,type:"Road"})}),(0,n.jsx)(x,{checked:!0,name:"Bản đồ vệ tinh",children:(0,n.jsx)(f.S,{bingkey:g,type:"AerialWithLabels"})})]}),e.map(t=>(0,n.jsxs)(c.J,{position:t.position,icon:v(t.status)||y,eventHandlers:{click:()=>z(t)},children:[(0,n.jsx)(u.u,{direction:"top",offset:[0,-10],opacity:.9,children:(0,n.jsx)(m.Z,{variant:"caption",sx:{fontWeight:"bold"},children:t.name})}),(0,n.jsxs)(d.G,{minWidth:250,maxWidth:300,children:[(0,n.jsx)(m.Z,{sx:{fontWeight:"bold",fontSize:14},children:t.name}),(0,n.jsx)(m.Z,{sx:{fontSize:12},children:t.description}),(0,n.jsxs)(h.Z,{sx:{mt:1,p:1,bgcolor:"#f5f5f5",borderRadius:"4px",fontSize:12},children:[(0,n.jsxs)(m.Z,{sx:{fontSize:12,display:"flex",justifyContent:"space-between"},children:[(0,n.jsx)("span",{children:(0,n.jsx)("b",{children:"T\xecnh trạng:"})}),(0,n.jsx)("span",{style:{color:"serious"===t.status?"#F44336":"moderate"===t.status?"#FF9800":"#4CAF50",fontWeight:"bold"},children:"serious"===t.status?"Nghi\xeam trọng":"moderate"===t.status?"Trung b\xecnh":"Nhẹ"})]}),(0,n.jsxs)(m.Z,{sx:{fontSize:12,mt:.5},children:[(0,n.jsx)("b",{children:"Loại sự cố:"})," ",t.type]}),(0,n.jsxs)(m.Z,{sx:{fontSize:12,mt:.5},children:[(0,n.jsx)("b",{children:"Thời gian ghi nhận:"})," ",t.date]})]})]})]},t.id))]})})}},39153:function(t,e,i){"use strict";i.d(e,{Sx:function(){return r},zV:function(){return s}});var n=i(1410),o=i(67294);function r(){return(0,n.mE)().map}function s(t){let e=r();return(0,o.useEffect)(function(){return e.on(t),function(){e.off(t)}},[e,t]),e}}}]);
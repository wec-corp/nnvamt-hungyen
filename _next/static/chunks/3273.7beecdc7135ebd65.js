"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3273],{88148:function(e,t,n){var a=n(13077),s=n(85893);t.Z=(0,a.Z)((0,s.jsx)("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12z"}),"Cancel")},38444:function(e,t,n){var a=n(13077),s=n(85893);t.Z=(0,a.Z)((0,s.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close")},55201:function(e,t,n){var a=n(13077),s=n(85893);t.Z=(0,a.Z)((0,s.jsx)("path",{d:"M3 10h11v2H3zm0-2h11V6H3zm0 8h7v-2H3zm15.01-3.13.71-.71c.39-.39 1.02-.39 1.41 0l.71.71c.39.39.39 1.02 0 1.41l-.71.71zm-.71.71-5.3 5.3V21h2.12l5.3-5.3z"}),"EditNote")},68963:function(e,t,n){var a=n(13077),s=n(85893);t.Z=(0,a.Z)((0,s.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"}),"Save")},87486:function(e,t,n){n.d(t,{Z:function(){return y}});var a=n(63366),s=n(87462),l=n(67294),i=n(8780),r=n(94780),o=n(66643),c=n(77527),d=n(83008),h=n(85206),u=n(57280),p=n(8480),x=n(1588),m=n(34867);function g(e){return(0,m.ZP)("PrivateSwitchBase",e)}(0,x.Z)("PrivateSwitchBase",["root","checked","disabled","input","edgeStart","edgeEnd"]);var Z=n(85893);let j=["autoFocus","checked","checkedIcon","className","defaultChecked","disabled","disableFocusRipple","edge","icon","id","inputProps","inputRef","name","onBlur","onChange","onFocus","readOnly","required","tabIndex","type","value"],v=e=>{let{classes:t,checked:n,disabled:a,edge:s}=e,l={root:["root",n&&"checked",a&&"disabled",s&&"edge".concat((0,o.Z)(s))],input:["input"]};return(0,r.Z)(l,g,t)},f=(0,c.ZP)(p.Z)(e=>{let{ownerState:t}=e;return(0,s.Z)({padding:9,borderRadius:"50%"},"start"===t.edge&&{marginLeft:"small"===t.size?-3:-12},"end"===t.edge&&{marginRight:"small"===t.size?-3:-12})}),b=(0,c.ZP)("input",{shouldForwardProp:d.Z})({cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1});var y=l.forwardRef(function(e,t){let{autoFocus:n,checked:l,checkedIcon:r,className:o,defaultChecked:c,disabled:d,disableFocusRipple:p=!1,edge:x=!1,icon:m,id:g,inputProps:y,inputRef:S,name:C,onBlur:k,onChange:w,onFocus:z,readOnly:E,required:A=!1,tabIndex:P,type:L,value:T}=e,D=(0,a.Z)(e,j),[H,R]=(0,h.Z)({controlled:l,default:!!c,name:"SwitchBase",state:"checked"}),B=(0,u.Z)(),I=d;B&&void 0===I&&(I=B.disabled);let K="checkbox"===L||"radio"===L,N=(0,s.Z)({},e,{checked:H,disabled:I,disableFocusRipple:p,edge:x}),W=v(N);return(0,Z.jsxs)(f,(0,s.Z)({component:"span",className:(0,i.Z)(W.root,o),centerRipple:!0,focusRipple:!p,disabled:I,tabIndex:null,role:void 0,onFocus:e=>{z&&z(e),B&&B.onFocus&&B.onFocus(e)},onBlur:e=>{k&&k(e),B&&B.onBlur&&B.onBlur(e)},ownerState:N,ref:t},D,{children:[(0,Z.jsx)(b,(0,s.Z)({autoFocus:n,checked:l,defaultChecked:c,className:W.input,disabled:I,id:K?g:void 0,name:C,onChange:e=>{if(e.nativeEvent.defaultPrevented)return;let t=e.target.checked;R(t),w&&w(e,t)},readOnly:E,ref:S,required:A,ownerState:N,tabIndex:P,type:L},"checkbox"===L&&void 0===T?{}:{value:T},y)),H?r:m]}))})},68431:function(e,t,n){var a=n(85893);n(67294);var s=n(88196),l=n(92365),i=n(40110),r=n(44723),o=n(96788),c=n(96727),d=n(51015),h=n(97182);t.Z=e=>{let{open:t,onClose:n,onConfirm:u,title:p,itemName:x,itemType:m,loading:g,error:Z,success:j,warningMessage:v}=e;return(0,a.jsxs)(s.Z,{open:t,onClose:g?void 0:n,children:[(0,a.jsx)(l.Z,{children:p}),(0,a.jsxs)(i.Z,{children:[Z&&(0,a.jsx)(r.Z,{severity:"error",sx:{mb:2},children:Z}),j&&(0,a.jsxs)(r.Z,{severity:"success",sx:{mb:2},children:["X\xf3a ",m.toLowerCase()," th\xe0nh c\xf4ng!"]}),(0,a.jsxs)(o.Z,{children:["Bạn c\xf3 chắc chắn muốn x\xf3a ",m.toLowerCase()," ",(0,a.jsx)("strong",{children:x}),"?"]}),(0,a.jsx)(o.Z,{color:"error",variant:"body2",sx:{mt:1},children:v||"Lưu \xfd: H\xe0nh động n\xe0y kh\xf4ng thể ho\xe0n t\xe1c."})]}),(0,a.jsxs)(c.Z,{children:[(0,a.jsx)(d.Z,{onClick:n,disabled:g,children:"Hủy"}),(0,a.jsx)(d.Z,{variant:"contained",color:"error",onClick:u,disabled:g||j,startIcon:g&&(0,a.jsx)(h.Z,{size:16,color:"inherit"}),children:g?"Đang x\xf3a...":"X\xe1c nhận x\xf3a"})]})]})}},53565:function(e,t,n){var a=n(85893),s=n(67294),l=n(93454),i=n(84166),r=n(88196),o=n(92365),c=n(52857),d=n(40110),h=n(61193),u=n.n(h),p=n(95639),x=n(46312);let m=e=>{let t=(0,s.useRef)(null);return(0,a.jsx)(u(),{handle:"#draggable-dialog-title",nodeRef:t,cancel:'[class*="MuiDialogContent-root"]',children:(0,a.jsx)(l.Z,{ref:t,...e})})};t.Z=e=>{let{children:t}=e,[n,l]=(0,s.useState)(null),[h,u]=(0,s.useState)(null),[g,Z]=(0,s.useState)(!1),[j,v]=(0,s.useState)({width:1200,height:700}),f=()=>{l(null),u(null),Z(!1),v({width:1200,height:700})};return(0,a.jsxs)(i.Z,{children:[t((e,t)=>{l(e),u(t),Z(!0)},f),(0,a.jsx)(r.Z,{open:g,onClose:f,PaperComponent:m,"aria-labelledby":"draggable-dialog-title",PaperProps:{sx:{width:"auto",height:"auto",maxWidth:"100vw",maxHeight:"100vh","&::-webkit-scrollbar":{display:"none"},msOverflowStyle:"none",scrollbarWidth:"none"}},children:(0,a.jsxs)(x.e,{size:j,onResizeStop:(e,t,n,a)=>{v({width:j.width+a.width,height:j.height+a.height})},minWidth:400,minHeight:300,maxWidth:"100vw",maxHeight:"100vh",enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},children:[(0,a.jsxs)(o.Z,{style:{position:"sticky",left:0,right:0,top:0,cursor:"move",display:"flex",justifyContent:"space-between",alignItems:"center",backgroundColor:"#007fff",color:"#fff",paddingTop:5,paddingBottom:5,zIndex:9999999},id:"draggable-dialog-title",children:[h,(0,a.jsx)(c.Z,{onClick:f,children:(0,a.jsx)(p.Z,{sx:{color:"red"}})})]}),(0,a.jsx)(d.Z,{sx:{p:"1.25rem","&.MuiDialogContent-root":{padding:"1.25rem"}},children:n})]})})]})}},76598:function(e,t,n){n.d(t,{Z:function(){return l}});var a=n(67294),s=n(21565);let l=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{pauseGlobalLoading:!0},[t,n]=(0,a.useState)(!1),{pauseGlobalLoading:l,resumeGlobalLoading:i}=(0,s.r)();return(0,a.useEffect)(()=>(e.pauseGlobalLoading&&l(),()=>{e.pauseGlobalLoading&&i()}),[e.pauseGlobalLoading,l,i]),{isSubmitting:t,submitForm:async e=>{n(!0);try{return await e()}finally{n(!1)}}}}},52598:function(e,t,n){n.r(t),n.d(t,{default:function(){return U}});var a=n(85893),s=n(67294),l=n(96788),i=n(81873),r=n(60762),o=n(60990),c=n(84166),d=n(44723),h=n(40492),u=n(95611),p=n(21038),x=n(52857),m=n(56912),g=n(39203),Z=n(88148),j=n(24772),v=n(38855),f=n(83947),b=n(89090),y=n(53565),S=n(13077),C=(0,S.Z)((0,a.jsx)("path",{d:"M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12z"}),"Label"),k=(0,S.Z)((0,a.jsx)("path",{d:"M17 7h-4v2h4c1.65 0 3 1.35 3 3s-1.35 3-3 3h-4v2h4c2.76 0 5-2.24 5-5s-2.24-5-5-5m-6 8H7c-1.65 0-3-1.35-3-3s1.35-3 3-3h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4zm-3-4h8v2H8z"}),"LinkOutlined"),w=n(38444),z=n(68963),E=n(55201),A=(0,S.Z)((0,a.jsx)("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm2 14h-3v3h-2v-3H8v-2h3v-3h2v3h3zm-3-7V3.5L18.5 9z"}),"NoteAdd"),P=n(68573),L=n(93454),T=n(29437),D=n(96727),H=n(51015),R=n(97182),B=n(64577),I=n(13754),K=n(76598),N=n(15243);let W=e=>{let{data:t,setPostSuccess:n,closeDialogs:i}=e,[r,o]=(0,s.useState)({}),[p,x]=(0,s.useState)(!1),[g,Z]=(0,s.useState)(null),{isSubmitting:j,submitForm:v}=(0,K.Z)(),{success:f,error:b}=(0,I.l)(),[y,S]=(0,s.useState)({id:(null==t?void 0:t.id)||0,name:(null==t?void 0:t.name)||null,path:(null==t?void 0:t.path)||null,pathKey:(null==t?void 0:t.pathKey)||null,module:(null==t?void 0:t.module)||null,permitAccess:(null==t?void 0:t.permitAccess)||!1}),E=e=>t=>{let n="checkbox"===t.target.type?t.target.checked:t.target.value;r[e]&&o({...r,[e]:void 0}),S({...y,module:"tai-nguyen-nuoc",[e]:n})},A=()=>{let e={};return y.name||(e.name="T\xean trang l\xe0 bắt buộc"),y.path?y.path.startsWith("/")||(e.path="Đường dẫn phải bắt đầu bằng /"):e.path="Đường dẫn l\xe0 bắt buộc",y.pathKey||(e.pathKey="Từ kh\xf3a l\xe0 bắt buộc"),o(e),0===Object.keys(e).length},W=async e=>{e.preventDefault(),Z(null),x(!1),A()&&await v(async()=>{try{let e={id:y.id,name:y.name||"",path:y.path||"",url:y.path||"",module:y.module||"tai-nguyen-nuoc",pathKey:y.pathKey||"",permitAccess:y.permitAccess||!1,icon:"",order:0},t=!1;if(y.id&&0!==y.id?(t=await B.authService.updateDashboard(y.id,e,!1))&&f(N.S.DASHBOARD.UPDATE_SUCCESS):(t=await B.authService.createDashboard(e,!1))&&f(N.S.DASHBOARD.CREATE_SUCCESS),t)return x(!0),setTimeout(()=>{"function"==typeof n&&n(!0),i()},1500),!0;{let e="Kh\xf4ng thể lưu trang. Vui l\xf2ng thử lại sau.";return Z(e),b(e),!1}}catch(t){console.error(t);let e=t.message||"Đ\xe3 xảy ra lỗi khi lưu trang";return Z(e),b(e),!1}})};return(0,a.jsxs)("form",{onSubmit:W,children:[g&&(0,a.jsx)(d.Z,{severity:"error",sx:{mb:3},children:g}),p&&(0,a.jsx)(d.Z,{severity:"success",sx:{mb:3},children:y.id&&y.id>0?N.S.DASHBOARD.UPDATE_SUCCESS:N.S.DASHBOARD.CREATE_SUCCESS}),(0,a.jsxs)(P.ZP,{container:!0,spacing:3,children:[(0,a.jsx)(P.ZP,{item:!0,xs:12,children:(0,a.jsx)(h.Z,{size:"small",fullWidth:!0,label:"T\xean trang",placeholder:"Nhập t\xean trang",value:(null==y?void 0:y.name)||"",onChange:E("name"),autoComplete:"off",required:!0,error:!!r.name,helperText:r.name,InputProps:{startAdornment:(0,a.jsx)(u.Z,{position:"start",children:(0,a.jsx)(C,{fontSize:"small",color:"action"})})}})}),(0,a.jsx)(P.ZP,{item:!0,xs:12,children:(0,a.jsx)(h.Z,{size:"small",fullWidth:!0,label:"Đường dẫn",placeholder:"/duong-dan-url",value:(null==y?void 0:y.path)||"",onChange:E("path"),autoComplete:"off",required:!0,error:!!r.path,helperText:r.path,InputProps:{startAdornment:(0,a.jsx)(u.Z,{position:"start",children:(0,a.jsx)(k,{fontSize:"small",color:"action"})})}})}),(0,a.jsx)(P.ZP,{item:!0,xs:12,children:(0,a.jsx)(h.Z,{size:"small",fullWidth:!0,label:"Từ kh\xf3a",placeholder:"tu-khoa-duong-dan",value:(null==y?void 0:y.pathKey)||"",onChange:E("pathKey"),autoComplete:"off",required:!0,error:!!r.pathKey,helperText:r.pathKey||"Từ kh\xf3a d\xf9ng để ph\xe2n quyền v\xe0 định danh trang"})}),(0,a.jsx)(P.ZP,{item:!0,xs:12,children:(0,a.jsxs)(L.Z,{variant:"outlined",sx:{p:2,bgcolor:e=>"dark"===e.palette.mode?"rgba(255,255,255,0.05)":"rgba(0,0,0,0.02)"},children:[(0,a.jsxs)(c.Z,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[(0,a.jsx)(l.Z,{variant:"body2",children:"Cho ph\xe9p truy cập"}),(0,a.jsx)(T.Z,{checked:!!(null==y?void 0:y.permitAccess),onChange:E("permitAccess"),color:"primary"})]}),(0,a.jsx)(l.Z,{variant:"caption",color:"text.secondary",children:"Khi được bật, trang sẽ hiển thị trong menu v\xe0 c\xf3 thể truy cập được"})]})})]}),(0,a.jsx)(m.Z,{sx:{my:3}}),(0,a.jsxs)(D.Z,{sx:{p:0,justifyContent:"space-between"},children:[(0,a.jsx)(H.Z,{variant:"outlined",onClick:i,disabled:j,startIcon:(0,a.jsx)(w.Z,{}),children:"Hủy"}),(0,a.jsx)(H.Z,{type:"submit",variant:"contained",disabled:j||p,startIcon:j?(0,a.jsx)(R.Z,{size:16,color:"inherit"}):(0,a.jsx)(z.Z,{}),children:j?"Đang lưu...":"Lưu"})]})]})};var O=e=>{let{data:t,isEdit:n,setPostSuccess:s,children:l}=e,i=n?"Chỉnh sửa trang truy cập":"Th\xeam trang truy cập mới";return(0,a.jsx)(y.Z,{children:(e,r)=>(0,a.jsx)(o.Z,{children:l?(0,a.jsx)(o.Z,{onClick:()=>e((0,a.jsx)(W,{data:t,setPostSuccess:s,isEdit:n,closeDialogs:r}),i),children:l}):n?(0,a.jsx)(p.Z,{title:"Chỉnh sửa trang",children:(0,a.jsx)(x.Z,{className:"tableActionBtn",onClick:()=>e((0,a.jsx)(W,{data:t,setPostSuccess:s,isEdit:n,closeDialogs:r}),i),children:(0,a.jsx)(E.Z,{fontSize:"small"})})}):(0,a.jsx)(p.Z,{title:"Th\xeam trang mới",children:(0,a.jsx)(x.Z,{className:"tableActionBtn",onClick:()=>e((0,a.jsx)(W,{data:t,setPostSuccess:s,isEdit:n,closeDialogs:r}),i),children:(0,a.jsx)(A,{})})})})})},_=n(39892),F=n(11163),M=n(59701),V=n(68431),U=()=>{let[e,t]=(0,s.useState)([]),[n,y]=(0,s.useState)(!1),[S,C]=(0,s.useState)(""),[k,w]=(0,s.useState)(!1),[z,E]=(0,s.useState)(!1),[A,P]=(0,s.useState)(null),[L,T]=(0,s.useState)(!1),[D,H]=(0,s.useState)(null),R=(0,F.useRouter)(),{getPermissionMap:K}=(0,M.Q)(),[W,U]=(0,s.useState)(null),{success:q,error:G}=(0,I.l)(),X=e.filter(e=>{var t,n;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase().includes(S.toLowerCase()))||(null===(n=e.path)||void 0===n?void 0:n.toLowerCase().includes(S.toLowerCase()))});(0,s.useEffect)(()=>{(async()=>{U(await K(R.asPath))})()},[K,R.asPath]);let Q=()=>{y(e=>!e)},J=e=>{H(e),w(!0)},Y=()=>{w(!1),P(null),T(!1),setTimeout(()=>{H(null)},200)},$=async()=>{if(D){E(!0),P(null);try{if(await B.authService.deleteDashboard(D.id,!1))T(!0),q(N.S.DASHBOARD.DELETE_SUCCESS),setTimeout(()=>{Y(),Q()},1500);else{let e="Kh\xf4ng thể x\xf3a trang n\xe0y";P(e),G(e)}}catch(t){let e=t.message||"Đ\xe3 xảy ra lỗi khi x\xf3a trang";P(e),G(e)}finally{E(!1)}}};return(0,s.useEffect)(()=>{(async()=>{try{let e=await B.authService.getDashboards();t(e)}catch(e){console.error("Error fetching dashboards:",e),t([])}finally{}})()},[n]),(0,a.jsxs)(r.Z,{children:[(0,a.jsx)(o.Z,{sx:{p:3,borderBottom:e=>"1px solid ".concat(e.palette.divider)},children:(0,a.jsxs)(c.Z,{direction:"row",alignItems:"center",spacing:1,children:[(0,a.jsx)(j.Z,{color:"primary"}),(0,a.jsx)(l.Z,{variant:"h6",children:"Quản l\xfd trang truy cập"}),(0,a.jsx)(i.Z,{size:"small",label:"".concat(e.length," trang"),color:"primary",sx:{ml:1}})]})}),L&&(0,a.jsx)(d.Z,{severity:"success",sx:{m:3,mt:2},onClose:()=>T(!1),children:"X\xf3a trang th\xe0nh c\xf4ng!"}),A&&(0,a.jsx)(d.Z,{severity:"error",sx:{m:3,mt:2},onClose:()=>P(null),children:A}),(0,a.jsxs)(o.Z,{sx:{p:3,pb:2,display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:2},children:[(0,a.jsx)(h.Z,{size:"small",placeholder:"T\xecm kiếm trang...",value:S,onChange:e=>C(e.target.value),sx:{minWidth:{xs:"100%",sm:300}},InputProps:{startAdornment:(0,a.jsx)(u.Z,{position:"start",children:(0,a.jsx)(v.Z,{fontSize:"small"})}),autoComplete:"off"}}),(0,a.jsxs)(o.Z,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,a.jsx)(p.Z,{title:"L\xe0m mới",children:(0,a.jsx)(x.Z,{color:"primary",onClick:()=>{Q(),q("Đ\xe3 l\xe0m mới dữ liệu")},size:"small",children:(0,a.jsx)(f.Z,{})})}),(0,a.jsx)(m.Z,{orientation:"vertical",flexItem:!0,sx:{mx:1}}),(null==W?void 0:W.CREATE)&&(0,a.jsx)(O,{data:null,setPostSuccess:Q,isEdit:!1})]})]}),(0,a.jsx)(m.Z,{}),(0,a.jsx)(_.Z,{columns:[{id:"name",label:"T\xean trang web",elm:e=>(0,a.jsx)(l.Z,{variant:"body1",fontWeight:500,children:e.name})},{id:"pathKey",label:"key",elm:e=>(0,a.jsx)(l.Z,{variant:"body2",sx:{color:"primary.main"},children:e.pathKey})},{id:"permitAccess",label:"Trạng th\xe1i",elm:e=>(0,a.jsx)(i.Z,{icon:e.permitAccess?(0,a.jsx)(g.Z,{fontSize:"small"}):(0,a.jsx)(Z.Z,{fontSize:"small"}),label:e.permitAccess?"Được truy cập":"Giới hạn truy cập",color:e.permitAccess?"success":"error",size:"small",variant:"outlined"})},{id:"actions",label:"#",pinned:"right"}],rows:X,pagination:!0,actions:e=>(0,a.jsxs)(o.Z,{className:"group_btn",children:[(null==W?void 0:W.EDIT)&&(0,a.jsx)(O,{data:e,setPostSuccess:Q,isEdit:!0}),(null==W?void 0:W.DELETE)&&(0,a.jsx)(p.Z,{title:"X\xf3a",children:(0,a.jsx)(x.Z,{size:"small",color:"error",className:"tableActionBtn deleteBtn",onClick:()=>J(e),children:(0,a.jsx)(b.Z,{fontSize:"small"})})})]})}),(0,a.jsx)(V.Z,{open:k,onClose:Y,onConfirm:$,title:"X\xe1c nhận x\xf3a trang",itemName:(null==D?void 0:D.name)||"",itemType:"trang",loading:z,error:A,success:L})]})}}}]);